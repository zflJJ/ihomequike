webpackJsonp([1],{"/wAz":function(e,t){},0:function(e,t){},"5OO2":function(e,t){},Avd7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={props:{show:{type:Boolean,default:!1},selectData:{type:Object,default:{}}},data:function(){return{pData1:[],pData2:[],pData3:[],selects:{select1:"",select2:"",select3:""},noData:!1}},methods:{close:function(e){this.$emit("cancel"),e.preventDefault()},finish:function(e){this.$emit("confirm",this.selects),e.preventDefault()},gearTouchStart:function(e){e.preventDefault();for(var t=e.target;!t.classList.contains("gear");)t=t.parentElement;clearInterval(t["int_"+t.id]),t["old_"+t.id]=e.targetTouches[0].screenY,t["o_t_"+t.id]=(new Date).getTime();var a=t.getAttribute("top");t["o_d_"+t.id]=a?parseFloat(a.replace(/em/g,"")):0,t.style.webkitTransitionDuration=t.style.transitionDuration="0ms"},gearTouchMove:function(e){e.preventDefault();for(var t=e.target;!t.classList.contains("gear");)t=t.parentElement;t["new_"+t.id]=e.targetTouches[0].screenY,t["n_t_"+t.id]=(new Date).getTime();var a=30*(t["new_"+t.id]-t["old_"+t.id])/window.innerHeight;t["pos_"+t.id]=t["o_d_"+t.id]+a,t.style["-webkit-transform"]="translate3d(0,"+t["pos_"+t.id]+"em,0)",t.setAttribute("top",t["pos_"+t.id]+"em"),e.targetTouches[0].screenY<1&&gearTouchEnd(e)},gearTouchEnd:function(e){e.preventDefault();for(var t=e.target;!t.classList.contains("gear");)t=t.parentElement;var a=(t["new_"+t.id]-t["old_"+t.id])/(t["n_t_"+t.id]-t["o_t_"+t.id]);Math.abs(a)<=.2?t["spd_"+t.id]=a<0?-.08:.08:Math.abs(a)<=.5?t["spd_"+t.id]=a<0?-.16:.16:t["spd_"+t.id]=a/2,t["pos_"+t.id]||(t["pos_"+t.id]=0),this.rollGear(t)},rollGear:function(e){var t=this,a=0,s=!1;function i(){e.style.webkitTransitionDuration=e.style.transitionDuration="200ms",s=!0}clearInterval(e["int_"+e.id]),e["int_"+e.id]=setInterval(function(){var n=e["pos_"+e.id],r=e["spd_"+e.id]*Math.exp(-.03*a);(n+=r,Math.abs(r)>.1)||(n=2*Math.round(n/2),i());n>0&&(n=0,i());var o=2*-(e.dataset.len-1);if(n<o&&(n=o,i()),s){var l=Math.abs(n)/2;t.setGear(e,l),clearInterval(e["int_"+e.id])}e["pos_"+e.id]=n,e.style["-webkit-transform"]="translate3d(0,"+n+"em,0)",e.setAttribute("top",n+"em"),a++},30)},setGear:function(e,t){var a=this,s=Math.round(t),i=e.getAttribute("data-type");this.selectData.link?"provs"===i?(a.selects.select1=a.pData1[s],a.resetData2(s),3===this.selectData.columns&&a.resetData3(0)):"city"===i&&2===this.selectData.columns?this.selects.select2=this.pData2[s]:"city"===i&&3===this.selectData.columns?(a.resetData3(s),this.selects.select2=this.pData2[s]):3===this.selectData.columns&&(this.selects.select3=this.pData3[s]):"provs"===i?a.selects.select1=a.pData1[s]:"city"===i?a.selects.select2=a.pData2[s]:a.selects.select3=a.pData3[s]},setTop:function(e){var t=this;this.$nextTick(function(){var a=t.$refs.province,s=t.$refs.city,i=t.$refs.county,n=0,r=0,o=0;if(e[0]&&e[0].value){t.selects.select1=e[0];for(var l=0,c=t.pData1.length;l<c;l++)if(t.pData1[l].value==e[0].value){n=-2*l;break}a.style.transform=a.style["-webkit-transform"]="translate3d(0,"+n+"em,0)",a.setAttribute("top",n+"em")}if(e[1]&&e[1].value){for(l=0,c=t.pData2.length;l<c;l++)if(t.pData2[l].value==e[1].value){r=-2*l;break}t.selects.select2=e[1],s.setAttribute("top",r+"em"),s.style["-webkit-transform"]="translate3d(0,"+r+"em,0)"}if(e[2]&&e[2].value){for(l=0,c=t.pData3.length;l<c;l++)if(t.pData3[l].value==e[2].value){o=-2*l;break}t.selects.select3=e[2],i.setAttribute("top",o+"em"),i.style["-webkit-transform"]="translate3d(0,"+o+"em,0)"}})},resetData2:function(e){var t=this;this.$nextTick(function(){var a=t.$refs.city;t.pData1[e]&&t.selectData.pData2[t.pData1[e].value]?t.pData2=t.selectData.pData2[t.pData1[e].value]:t.pData2=[],t.selects.select2=t.pData2[0],a.setAttribute("top",0),a.style["-webkit-transform"]="translate3d(0, 0, 0)"})},resetData3:function(e){var t=this;this.$nextTick(function(){var a=t.$refs.county;t.pData2.length>0&&t.pData2[e]?t.pData3=t.selectData.pData3[t.pData2[e].value]:t.pData3=[],t.selects.select3=t.pData3[0],a.setAttribute("top",0),a.style["-webkit-transform"]="translate3d(0, 0, 0)"})},init:function(){if(this.selectData.link){if(console.log(this.selectData),0==this.selectData.default.length)return;this.pData1=this.selectData.pData1,this.pData2=this.selectData.pData2[this.pData1[0].value],3===this.selectData.columns&&(this.pData3=this.selectData.pData3[this.pData2[0].value])}else this.pData1=this.selectData.pData1,this.pData2=this.selectData.pData2,this.pData3=this.selectData.pData3;1===this.selectData.columns?this.selects.select1=this.pData1[0]:2===this.selectData.columns?(this.selects.select1=this.pData1[0],this.selects.select2=this.pData2[0]):3===this.selectData.columns&&(this.selects.select1=this.pData1[0],this.selects.select2=this.pData2[0],this.selects.select3=this.pData3[0])}},created:function(){var e=this;this.init(),this.$root.eventHub.$on("init",function(){e.init()})},watch:{selectData:{handler:function(){this.init()},deep:!0},show:function(e){e&&this.setTop(this.selectData.default||[])}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"h-picker"}},[a("transition",{attrs:{name:"fade"}},[e.show?a("div",{staticClass:"area_ctrl"},[a("div",{staticClass:"area_btn_box"},[a("div",{staticClass:"area_btn larea_cancel",on:{click:e.close}},[e._v("取消")]),e._v(" "),a("div",{staticClass:"area_btn larea_finish",on:{click:e.finish}},[e._v("确定")])]),e._v(" "),a("div",{staticClass:"area_roll_mask"},[a("div",{staticClass:"area_roll"},[a("div",[a("div",{ref:"province",staticClass:"gear area_province",attrs:{top:"0","data-areatype":"area_province","data-type":"provs","data-len":e.pData1.length,val:"5"},on:{touchstart:e.gearTouchStart,touchmove:e.gearTouchMove,touchend:e.gearTouchEnd}},e._l(e.pData1,function(t,s){return a("div",{key:s,staticClass:"tooth"},[e._v(e._s(t.text))])})),e._v(" "),a("div",{staticClass:"area_grid"})]),e._v(" "),e.selectData.columns>1?a("div",[a("div",{ref:"city",staticClass:"gear area_city",attrs:{top:"0","data-areatype":"area_city","data-type":"city","data-len":e.pData2.length,val:"5"},on:{touchstart:e.gearTouchStart,touchmove:e.gearTouchMove,touchend:e.gearTouchEnd}},e._l(e.pData2,function(t,s){return a("div",{key:s,staticClass:"tooth"},[e._v(e._s(t.text))])})),e._v(" "),a("div",{staticClass:"area_grid"})]):e._e(),e._v(" "),e.selectData.columns>2?a("div",[a("div",{ref:"county",staticClass:"gear \n                  area_county",attrs:{top:"0","data-areatype":"area_county","data-len":e.pData3.length,val:"5"},on:{touchstart:e.gearTouchStart,touchmove:e.gearTouchMove,touchend:e.gearTouchEnd}},e._l(e.pData3,function(t,s){return a("div",{key:s,staticClass:"tooth"},[e._v(e._s(t.text))])})),e._v(" "),a("div",{staticClass:"area_grid"})]):e._e()])])]):e._e()])],1)},staticRenderFns:[]};var n=a("VU/8")(s,i,!1,function(e){a("zxHr")},"data-v-4517185a",null);t.default=n.exports},B1Ov:function(e,t){},Bt7k:function(e,t){},DahS:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAlCAYAAAAqXEs9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2MDc5NUM0MzIxMEQxMUU4ODRERkNGREVBQkFDNjBFMiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2MDc5NUM0NDIxMEQxMUU4ODRERkNGREVBQkFDNjBFMiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjYwNzk1QzQxMjEwRDExRTg4NERGQ0ZERUFCQUM2MEUyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjYwNzk1QzQyMjEwRDExRTg4NERGQ0ZERUFCQUM2MEUyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+GHLgGwAAAatJREFUeNrM2L1KBDEQB/C7wULFR7DzbCy0FBRBxRewEUQs/H4ldxVBEAQbX0BUsLHVwuau9BX8qO6cgQmE5TY7mWQWA384kuPyI9lNcukWRdH5B2US80sfgCu6mHXMcsuQOcwb5gtzRR4HusY8YV4x5wy0Lj3MM2aRB+YAswU8XHveF88wF8aoHg/AbKX+B3juPioNR4aoOgxN2Yubsm3MZwuo+QDmxH+oB5hNYxRhHgOYoQ+i0jdEiTBVkBVKjBkHyo2KwtSBcqGiMSFQE+qyAaXCNIFCqMMASo2RgGJRSRgpSIpKxlCZiHhjHKraKaFmMCupmJgRahqpnRwYDSiESsZoQQ51WtM24Lah5oe1IHqAy8DxotTufaDEjHubpOtUVlAd5i5y8cwCCq0zu4oVPQkkWfT6OVCQCZOy90WBNNtBEgosjhApKDDAJKHACKNGgSFGhQIh5li7N8WiwNt/QphRhj+KIpQD3RtjpKiOu/1YaAEjQa25249br6E0xDShptyU7WM2MKt8P2SJ8VHU5zv3d4N5cIf8Ed9mtV3odLmEmcZ8U8WfAAMAzHu5xGXWJFkAAAAASUVORK5CYII="},FY8l:function(e,t){},MA6U:function(e,t,a){e.exports=a.p+"static/img/product.d7cce8e.jpg"},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("7+uW"),i=a("8+8L"),n=a("Au9i"),r=a.n(n),o=(a("d8/S"),a("/wAz"),{name:"app",data:function(){return{transitionName:"slide-left"}},methods:{GetUrlParam:function(e){var t=window.location.href.split("?");if(t.length>1){for(var a,s=t[1].split("&"),i=0;i<s.length;i++)if(null!=(a=s[i].split("="))&&a[0]==e)return a[1];return""}return""}},created:function(){var e=null,t=window.location.href,a=t.indexOf("?"),s=t.substr(a+1),i=t.indexOf("#/login");if(-1!==i){var n=s.indexOf("openId");e=s.substr(n+7),localStorage.setItem("openId",e)}else{i=t.indexOf("#/home");for(var r=t.substring(a+1,i).split("&"),o=[],l=0;l<r.length;l++)o.push(r[l].split("="))}this.GetUrlParam("userId")&&localStorage.setItem("userId",this.GetUrlParam("userId")),this.GetUrlParam("parklotId")&&localStorage.setItem("myParklotId",this.GetUrlParam("parklotId")),this.GetUrlParam("unionId")&&localStorage.setItem("unionId",this.GetUrlParam("unionId")),this.GetUrlParam("openId")&&localStorage.setItem("openId",this.GetUrlParam("openId")),this.GetUrlParam("orderId")&&localStorage.setItem("orderId",this.GetUrlParam("orderId"));var c=window.navigator.userAgent,d=(c.indexOf("Android")>-1||c.indexOf("Adr"),"");if(!0===!!c.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/))d="iPhone";else{for(var u=c.split(";"),p=null,v=0;v<u.length;v++)if(u[v].indexOf("Build/")>0){p=v;break}d=u[p].substring(0,u[p].indexOf("Build/"))}localStorage.setItem("phoneNum",d)},computed:{exclude:function(){return this.$store.state.exclude}},watch:{$route:function(e,t){"/home"==e.path?this.transitionName="slide-left":this.transitionName="slide-right"}}}),l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("transition",{attrs:{name:this.transitionName}},[t("keep-alive",{attrs:{exclude:"exclude"}},[t("router-view",{staticClass:"child-view"})],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,l,!1,function(e){a("umeQ")},null,null).exports,d=a("/ocq"),u=a("mvHQ"),p=a.n(u),v=function(e,t){localStorage.setItem(e,p()(t)),setTimeout(function(){localStorage.removeItem(e)},6048e5)},m=function(e){return JSON.parse(localStorage.getItem(e))},h=function(e){localStorage.removeItem(e)},f={name:"subHeader",data:function(){return{}},computed:{showMore:function(){return"我的账户"==this.headerMark}},props:["headerMark"],methods:{goBack:function(){localStorage.getItem("H5_parkName");if("预约详情"==this.headerMark||"预约"==this.headerMark);else if("我的卡券"==this.headerMark)this.$router.push("payMentDt");else if("支付完成"==this.headerMark){"reservationPaking"==localStorage.getItem("goBackFlag")?this.$router.push("reservationOld"):this.$router.push("reservationInfo")}else if("添加车辆"==this.headerMark)this.$router.push("licensePlate");else if("我的车辆"==this.headerMark)this.$router.push("reservationOld");else if("支付订单"==this.headerMark){"reservationPaking"==localStorage.getItem("goBackFlag")?this.$router.push("reservationPaking"):this.$router.push("reservationBookingUnpaid")}else this.$router.go(-1)}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"header p-a",attrs:{id:"sub-header"}},[a("div",{staticClass:"top-cont t-c p-r"},[e._v("\n        "+e._s(e.headerMark)+"\n      "),a("div",{staticClass:"back p-a"}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"more p-a"},[e._v("更多")]),e._v(" "),a("div",{staticClass:"back-mask p-a",on:{click:e.goBack}})])])},staticRenderFns:[]};var _=a("VU/8")(f,g,!1,function(e){a("XsYe")},null,null).exports,C=a("Xxa5"),I=a.n(C),T=a("exGp"),b=a.n(T),k=(a("//Fk"),{requestUrl:"https://www.qhiehome.com/"}),y=function(e){var t=new Date(e),a=t.getFullYear()+"",s=t.getMonth()+1+"",i=t.getDate()+"",n=t.getHours()+"",r=t.getMinutes()+"",o=t.getSeconds()+"",l=t.getMilliseconds()+"";return s=("00"+s).substr(s.length),i=("00"+i).substr(i.length),n=("00"+n).substr(n.length),o=("00"+o).substr(o.length),a+"-"+s+"-"+i+" "+n+":"+(r=("00"+r).substr(r.length))+":"+o+":"+(l=("00"+l).substr(l.length))},w=a("GQaK"),D=a("mtWM"),x=a.n(D),S={state:{currentLocation:{},parkItems:[],phone:"",isphone:null,exclude:[],appId:"wxe44228e45ce071dc",map:null,orderId:"",estateName:"",startTime:"",plateNo:"",createTime:"",createFmTime:"",endTime:"",address:"",orgX:"",orgY:"",desX:"",desY:"",lngcenter:"",latcenter:"",AMap:null}};x.a.defaults.timeout=2e4,x.a.defaults.headers.post["Content-Type"]="application/json;charset=UTF-8",x.a.defaults.withCredentials=!0;var N,F,O=(N=b()(I.a.mark(function e(t,a,s){var i;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.eventHub.$http[t](a,s);case 2:return i=e.sent,e.abrupt("return",i.data);case 4:case"end":return e.stop()}},e,this)})),function(e,t,a){return N.apply(this,arguments)}),M=this,A=k.requestUrl,B=function(e,t){return O("post",A+"apiread/parklot/reserve/enter",{user_id:e,parklot_id:t,timestamp:(new Date).getTime()})},L=function(e,t){return O("post",A+"apiread/coupon/get",{user_id:e,page_num:t,timestamp:String(+new Date)})},R=function(e){return O("post",A+"apiwrite/reserve/cancel",{order_id:e,timestamp:(new Date).getTime()})},E=function(e,t,a,s,i,n){return O("post",A+e,{order_id:t,channel:a,coupon_id:s,type:5,wapUrl:i,spbillCreateIp:n,timestamp:(new Date).getTime()})},H=(F=b()(I.a.mark(function e(t,a){var s,i,n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s="http://v.juhe.cn/sms/send?tpl_id=41356&key=c718da9eb368b06d145a81f5661e093d&mobile="+t+"&tpl_value=%23code%23%3D"+a,i={method:"GET",mode:"no-cors"},e.next=4,fetch(s,i);case 4:return n=e.sent,e.next=7,n.text();case 7:e.sent;case 8:case"end":return e.stop()}},e,M)})),function(e){return O("post",A+"apiread/order/reserve/detail/query",{order_id:e,timestamp:(new Date).getTime()})}),P=function(e,t){return O("post",A+"lock/control",{lock_id:e,command:t,timestamp:(new Date).getTime()})},j={name:"appointInfo",data:function(){return{orderId:"",estateName:"",startTime:"",plateNo:"",createTime:"",createFmTime:"",endTime:"",address:"",hour:"00",minutes:"00",seconds:"00",miliSeconds:"00",interval:"",orgX:"",orgY:"",desX:"",desY:"",orderData:{},countdown:null,islockshow:!1,seconds1302:"00",minutes1302:"00",hours1302:"00",AMAP:null,lockId:null,getOrderFlag:!1,network:!0,goPayFlag:!0,intervalMy:null,count:0,visibFlag:!0,leaveFlag:!1}},components:{},computed:{},methods:{goPay:function(){this.getOrder(1)},_initScroll:function(){var e=this;this.$nextTick(function(){e.scroll?e.scroll.refresh():e.scroll=new w.a(e.$refs.appoitInfoBox,{probeType:3,scrollY:!0,click:!0})})},getOrder:function(e){var t=this,a={order_id:localStorage.getItem("orderId"),timestamp:(new Date).getTime()};0==this.count?this.count=1:1!=e&&(a.isQuickReserve=1),this.$http.post(k.requestUrl+"apiread/order/reserve/detail/query",a).then(function(a){if(!t.leaveFlag)if(alert(p()(a.body.data)),2e3===a.body.error_code){if(1303==a.body.data.state)return t.getOrderFlag=!0,localStorage.setItem("H5_fees",a.body.data.parkingFee),localStorage.setItem("orderId",a.body.data.orderId),t.orderData=a.body.data,t.dispoceOrderDat(a.body.data),localStorage.setItem("routerFlag","reservationPaking"),localStorage.setItem("goBackFlag","reservationPaking"),0==a.body.data.parkingFee&&1303==a.body.data.state?(t.leaveFlag=!0,t.$router.push("payToComplete")):0!=a.body.data.parkingFee&&1303==a.body.data.state&&(t.leaveFlag=!0,localStorage.setItem("H5_order_state",a.body.data.state),t.$router.push("payMentDt")),!1;1304==a.body.data.state||1307==a.body.data.state||1308==a.body.data.state||1309==a.body.data.state||1310==a.body.data.state?(localStorage.setItem("routerFlag","reservationPaking"),localStorage.setItem("goBackFlag","reservationPaking"),t.$router.push("payToComplete")):1302==a.body.data.state&&t.visibFlag&&(t.intervalMy&&clearTimeout(t.intervalMy),t.intervalMy=null,t.intervalMy=setTimeout(function(){t.getOrder()},1e4)),t.getOrderFlag=!1,t.lockId=null,t.desX=a.body.data.lng,t.desY=a.body.data.lat,t.lockId=a.body.data.lockId,t.dispoceOrderDat(a.body.data),t.orderData=a.body.data,1==e&&(n.Indicator.close(),Object(n.Toast)({message:"请先离场再支付",position:"bottom",duration:2e3}))}else console.log(a,"错误码是"+a.error_code)})},dispoceOrderDat:function(e){var t=0;if(null===e.reserveCouponFee)t=e.reserveFee;else{var a;t=(a=(e.reserveFee-e.reserveCouponFee).toFixed(2))<=0?0:a}this.$set(e,"zpayReserve",t);var s=y(e.startTime),i=y(e.endTime);if(e.dHandler=s.substr(5,11)+" 至 "+i.substr(5,11),null===e.enterTime)e.enterTime="————";else{var n=y(e.enterTime);e.enterTime=n.substr(5,11)}if(null===e.leaveTime)e.leaveTime="————";else{var r=y(e.leaveTime);e.leaveTime=r.substr(5,11)}if(this.countdown=e.enterCountdownTime,null!==e.overTime){var o=parseInt(e.overTime%864e5/36e5),l=parseInt(e.overTime%36e5/6e4),c=e.overTime%6e4/1e3;e.overTime=o+":"+l+":"+c}if(1300===e.state?e.dstateInfo="未支付":1301===e.state?e.dstateInfo="已预约":1302===e.state?e.dstateInfo="停车中":1303===e.state?e.dstateInfo="离场未支付":1304===e.state?e.dstateInfo="已支付":1309===e.state?e.dstateInfo="已取消":1308!==e.state&&1307!==item.state&&1310!==item.state||(e.dstateInfo="超时已取消"),1302===e.state){var d=e.stopTime;this.addTime(d)}},addTime:function(e){var t=this;console.log(e);var a=parseInt(e/36e5),s=parseInt(e%36e5/6e4),i=parseInt(e%6e4/1e3);console.log(a,s,i),clearInterval(n);var n=setInterval(function(){59===++i&&(i=0,s++),59===s&&(a++,s=0),s+="",a+="",1===(i+="").length&&(i="0"+i),1===s.length&&(s="0"+s),1===a.length&&(a="0"+a),t.seconds1302=i,t.minutes1302=s,t.hours1302=a,"00"==t.seconds1302&&"00"==t.minutes1302&&"00"==t.hours1302&&clearInterval(n)},1e3)},lockModel:function(){this.islockshow=!0},closeModel:function(){this.islockshow=!1},closeCs:function(e){e.cancelBubble=!0},lockEvnet:function(e){if(!this.network||!window.navigator.onLine)return Object(n.Toast)({message:"当前网络无连接",position:"bottom",duration:2e3}),!1;this.lockDown(e),1==e?Object(n.Toast)({message:"车锁正在升起",position:"bottom",duration:2e3}):2==e&&Object(n.Toast)({message:"车锁正在下降",position:"bottom",duration:2e3})},lockDown:function(e){var t=this;return b()(I.a.mark(function a(){return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,P(t.lockId,e);case 2:a.sent;case 3:case"end":return a.stop()}},a,t)}))()},visibEvent:function(){"hidden"==document.visibilityState?(console.log("执行了"),clearTimeout(this.intervalMy),this.visibFlag=!1):(this.visibFlag=!0,this.seconds1302="00",this.minutes1302="00",this.hours1302="00",this.hour="00",this.minutes="00",this.seconds="00",clearTimeout(this.intervalMy),this.getOrder())}},created:function(){window.addEventListener("online",function(){return e.network=!0,!0},!0),window.addEventListener("offline",function(){return e.network=!1,Object(n.Toast)({message:"当前网络无连接",position:"bottom",duration:2e3}),n.Indicator.close(),!1},!0),this._initScroll();new Date;var e=this},activated:function(){document.addEventListener("visibilitychange",this.visibEvent,!1),this.getOrder(),this.leaveFlag=!1},deactivated:function(){clearTimeout(this.intervalMy),document.removeEventListener("visibilitychange",this.visibEvent,!1)},mounted:function(){},beforeRouteLeave:function(e,t,a){n.MessageBox.close(!1),a()},watch:{$route:function(e,t){n.MessageBox.close(!1)}}},$={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"appoint-info"}},[a("div",{ref:"appoitInfoBox",staticClass:"appoit-info-box"},[a("div",{attrs:{sytle:"position: relative;"}},[a("div",{staticClass:"content"},[2===e.orderData.type?a("div",{staticClass:"guide-show"},[a("div",{staticClass:"imgstyle"},[a("div",{staticClass:"img-car-text"},[2===e.orderData.type?a("span",[a("span",{staticClass:"border-text"},[e._v("车位")]),a("span",[e._v("编号")])]):e._e()]),e._v(" "),a("div",{staticClass:"car-ploate"},[2===e.orderData.type&&null!==e.orderData.parklocNumber?a("div",[e._v("\n                "+e._s(e.orderData.parklocNumber)+"\n              ")]):e._e()])])]):e._e(),e._v(" "),a("div",{staticClass:"plate"},[a("div",{staticClass:"plate-info"},[a("p",[a("span",{staticClass:"name-text"},[e._v(e._s(e.orderData.parklotName))]),e._v(" "),0===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室内")]):1===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室外")]):2===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室内+室外")]):e._e()])]),e._v(" "),a("div",{staticClass:"plate-content"},[e._v("\n            "+e._s(e.orderData.address)+"\n          ")])])]),e._v(" "),a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("订单状态")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.dstateInfo))])])]),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("订单编号")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.serialNumber))])])])]),e._v(" "),a("div",{staticClass:"order-info"},[e._v("\n        预约订单明细\n      ")]),e._v(" "),a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("预约时间")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.dHandler))])])]),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("预约费")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v("￥ "+e._s(e.orderData.reserveFee))])])])]),e._v(" "),0!=e.orderData.payChannelReserve?a("div",{staticClass:"order-info"},[e._v("\n        预约支付明细\n      ")]):e._e(),e._v(" "),0!=e.orderData.payChannelReserve?a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("支付方式")]),e._v(" "),a("span",{staticClass:"ta-info"},[1===e.orderData.payChannelReserve?a("span",[e._v("\n                支付宝：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):2===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):3===e.orderData.payChannelReserve?a("span",[e._v("\n                现金：￥ "+e._s(e.orderData.reserveFee)+"\n              ")]):4===e.orderData.payChannelReserve?a("span",[e._v("\n                优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n              ")]):5===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):6===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):e._e()])])])]):e._e(),e._v(" "),a("div",{staticClass:"order-info lastOne"},[e._v("\n          停车订单明细\n        ")]),e._v(" "),a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("入场时间")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.enterTime))])])])])])]),e._v(" "),a("div",[e.orderData.lockId?a("div",{staticClass:"cancel p-a t-c"},[a("div",{staticClass:"item2-sytle",on:{click:e.lockModel}},[e._v("控制车锁")]),e._v(" "),a("div",{staticClass:"canle-style",on:{click:e.goPay}},[e._v("离场支付")])]):(e.getOrderFlag,a("div",{staticClass:"cancel p-a t-c"},[a("div",{staticClass:"item2-sytle2",on:{click:e.goPay}},[e._v("离场支付")])]))]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.islockshow,expression:"islockshow"}],staticClass:"alert-index",on:{click:e.closeModel}},[a("div",{staticClass:"al-info",on:{click:e.closeCs}},[a("div",{staticClass:"al-header"},[e._v("控制车锁")]),e._v(" "),a("div",{staticClass:"al-conter"},[a("div",{staticClass:"lock-img"},[a("div",{staticClass:"lock-up lock-wh",on:{click:function(t){e.lockEvnet(1)}}})]),e._v(" "),a("div",{staticClass:"lock-img"},[a("div",{staticClass:"lock-down lock-wh",on:{click:function(t){e.lockEvnet(2)}}})])]),e._v(" "),a("div",{staticClass:"al-header",on:{click:e.closeModel}},[e._v("关闭")])])]),e._v(" "),a("div",{staticStyle:{display:"none"},attrs:{id:"gdAMp"}})])},staticRenderFns:[]};var G=a("VU/8")(j,$,!1,function(e){a("m5d5")},null,null).exports,U=(a("NYxO"),{name:"reservationInfo",data:function(){return{headerMark:"预约详情",orderId:"",parklotId:"",estateName:"",startTime:"",plateNo:"",createTime:"",createFmTime:"",endTime:"",address:"",miliSeconds:"00",interval:"",orgX:"",orgY:"",desX:"",desY:"",orderData:{},countdown:null,islockshow:!1,seconds1302:"00",minutes1302:"00",hours1302:"00",AMAP:null,lockId:null,network:!0,count:0}},components:{subHeader:_},methods:{_initScroll:function(){var e=this;this.$nextTick(function(){e.scroll?e.scroll.refresh():e.scroll=new w.a(e.$refs.appoitInfoBox,{probeType:3,scrollY:!0,click:!0})})},getOrder:function(){var e=this,t=this,a={order_id:window.localStorage.getItem("orderId"),timestamp:(new Date).getTime()};0==this.count?this.count=1:a.isQuickReserve=1,this.$http.post(k.requestUrl+"apiread/order/reserve/detail/query",a).then(function(a){2e3==a.body.error_code&&(null==a.body.data?t.getOrder():1301==a.body.data.state&&(null==a.body.data.parkingState?t.getOrder():a.body.data.parkingState&&(1302==a.body.data.parkingState?(localStorage.setItem("orderId",a.body.data.orderParkingId),e.$router.push("reservationPaking")):1304!=a.body.data.parkingState&&1307!=a.data.body.parkingState&&1308!=a.data.body.parkingState&&1309!=a.data.body.parkingState&&1310!=a.body.data.parkingState||e.$router.push("reservationOld")),e.lockId=null,e.desX=a.body.data.lng,e.desY=a.body.data.lat,e.lockId=a.body.data.lockId,e.dispoceOrderDat(a.body.data),e.orderData=a.body.data,e.parklotId=a.body.data.parklotId,e.scroll.refresh()))}).catch(function(e){console.log(e)})},dispoceOrderDat:function(e){var t=0;if(null===e.reserveCouponFee)t=e.reserveFee;else{var a;t=(a=100*e.reserveFee-100*e.reserveCouponFee)<=0?0:a/100}this.$set(e,"zpayReserve",t);var s=y(e.startTime),i=y(e.endTime);if(e.dHandler=s.substr(5,11)+" 至 "+i.substr(5,11),null===e.enterTime)e.enterTime="————";else{var n=y(e.enterTime);e.enterTime=n.substr(0,16)}if(null===e.leaveTime)e.leaveTime="————";else{var r=y(e.leaveTime);e.leaveTime=r.substr(0,16)}if(this.countdown=Math.floor(e.enterCountdownTime/1e3),this.downCounts(),null!==e.overTime){var o=parseInt(e.overTime%864e5/36e5),l=parseInt(e.overTime%36e5/6e4),c=e.overTime%6e4/1e3;e.overTime=o+":"+l+":"+c}if(1300===e.state?e.dstateInfo="未支付":1301===e.state?e.dstateInfo="已预约":1302===e.state?e.dstateInfo="停车中":1303===e.state?e.dstateInfo="离场未支付":1304===e.state?e.dstateInfo="已支付":1309===e.state?e.dstateInfo="已取消":1308!==e.state&&1307!==item.state&&1310!==item.state||(e.dstateInfo="超时已取消"),1302===e.state){var d=e.stopTime;this.addTime(d)}},addTime:function(e){var t=this;console.log(e);var a=parseInt(e/36e5),s=parseInt(e%36e5/6e4),i=parseInt(e%6e4/1e3);console.log(a,s,i),clearInterval(n);var n=setInterval(function(){59===++i&&(i=0,s++),59===s&&(a++,s=0),s+="",a+="",1===(i+="").length&&(i="0"+i),1===s.length&&(s="0"+s),1===a.length&&(a="0"+a),t.seconds1302=i,t.minutes1302=s,t.hours1302=a,"00"==t.seconds1302&&"00"==t.minutes1302&&"00"==t.hours1302&&clearInterval(n)},1e3)},lockModel:function(){this.islockshow=!0},closeModel:function(){this.islockshow=!1},closeCs:function(e){e.cancelBubble=!0},lockEvnet:function(e){if(!this.network||!window.navigator.onLine)return Object(n.Toast)({message:"当前网络无连接",position:"bottom",duration:2e3}),!1;this.lockDown(e),1==e?Object(n.Toast)({message:"车锁正在升起",position:"bottom",duration:2e3}):2==e&&Object(n.Toast)({message:"车锁正在下降",position:"bottom",duration:2e3})},lockDown:function(e){var t=this;return b()(I.a.mark(function a(){return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,P(t.lockId,e);case 2:a.sent;case 3:case"end":return a.stop()}},a,t)}))()},downCounts:function(){var e=this;null!=this.interval&&clearInterval(this.interval),this.countdown<=0||(this.interval=setInterval(function(){e.countdown--,e.countdown<=0&&clearInterval(e.interval)},1e3))},cancelOrder:function(){var e=this,t=this.orderData.freeCancellationTime,a='\n              <div class="ordermessage-info">\n                <div class="is-text">\n                  车位已经为您保留，'+t+"分钟内可免费取消，超过"+t+"分钟不退还预约费。是否确认取消预约\n                </div>\n              </div>";n.MessageBox.confirm("",{title:"提示",message:a,confirmButtonText:"取消预约",cancelButtonText:"保留预约",closeOnClickModal:!1}).then(function(t){e.cancelAppoint()}).catch(function(e){})},cancelAppoint:function(){var e=this;return b()(I.a.mark(function t(){var a;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R(e.orderId);case 2:2e3===(a=t.sent).error_code?(localStorage.setItem("myParklotId",e.parklotId),e.$router.push({name:"reservationOld",query:{parklotId:e.parklotId}})):2903==a.error_code?e.$router.push("reservationPaking"):(Object(n.Toast)({message:"页面超时，正在为您获取最新数据",duration:1500}),e.getOrder());case 4:case"end":return t.stop()}},t,e)}))()},hiddenFun:function(){var e=this;if("hidden"==document.visibilityState)clearInterval(e.interval),e.interval=null,e.hiddenDate=(new Date).getTime(),localStorage.setItem("hiddenTime",e.hiddenDate);else{e.showDate=(new Date).getTime();var t=parseInt(localStorage.getItem("hiddenTime")),a=Math.floor((e.showDate-t)/1e3);e.countdown<=a?e.countdown=0:e.countdown=e.countdown-a,e.downCounts()}}},computed:{hour:function(){var e=Math.floor(this.countdown/3600);return e<10?"0"+e:e},minutes:function(){var e=Math.floor(this.countdown%3600/60);return e<10?"0"+e:e},seconds:function(){var e=this.countdown%60;return e<10?"0"+e:e}},created:function(){window.addEventListener("online",function(){return this.network=!0,!0},!0),window.addEventListener("offline",function(){return this.network=!1,Object(n.Toast)({message:"当前网络无连接",position:"bottom",duration:2e3}),n.Indicator.close(),!1},!0),this._initScroll();new Date},activated:function(){this.count=0,this.orderId=JSON.parse(localStorage.getItem("orderId")),this.getOrder(),document.addEventListener("visibilitychange",this.hiddenFun,!1)},deactivated:function(){clearInterval(this.interval),localStorage.removeItem("hiddenTime"),document.removeEventListener("visibilitychange",this.hiddenFun,!1)},mounted:function(){},beforeRouteLeave:function(e,t,a){n.MessageBox.close(!1),a()},watch:{$route:function(e,t){n.MessageBox.close(!1)}}}),Y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"appoint-info"}},[a("div",{ref:"appoitInfoBox",staticClass:"appoit-info-box"},[a("div",{attrs:{sytle:"position: relative;"}},[a("div",{staticClass:"content"},[2==e.orderData.type?a("div",{staticClass:"guide-show"},[a("div",{staticClass:"imgstyle"},[a("div",{staticClass:"img-car-text"},[e.orderData.parklocNumber?a("span",[a("span",{staticClass:"border-text"},[e._v("车位")]),e._v(" "),a("span",[e._v("编号")])]):e._e()]),e._v(" "),a("div",{staticClass:"car-ploate"},[e.orderData.parklocNumber?a("div",[e._v("\n                "+e._s(e.orderData.parklocNumber)+"\n              ")]):e._e()])])]):e._e(),e._v(" "),a("div",{staticClass:"plate"},[a("div",{staticClass:"plate-info"},[a("p",[a("span",{staticClass:"name-textOne"},[e._v(e._s(e.orderData.parklotName))]),e._v(" "),0===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室内")]):1===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室外")]):2===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室内+室外")]):e._e()])]),e._v(" "),a("div",{staticClass:"plate-content"},[e._v("\n            "+e._s(e.orderData.address)+"\n          ")])])]),e._v(" "),a("div",{staticClass:"plate-card"},[1301===e.orderData.state?[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("入场时间")]),e._v(" "),a("div",{staticClass:"time-add"},[a("div",{staticClass:"time-style"},[e._v(e._s(e.hour))]),e._v(" "),a("div",{staticClass:"time-text"},[e._v("时")]),e._v(" "),a("div",{staticClass:"time-style"},[e._v(e._s(e.minutes))]),e._v(" "),a("div",{staticClass:"time-text"},[e._v("分")]),e._v(" "),a("div",{staticClass:"time-style"},[e._v(e._s(e.seconds))])])])])]:e._e(),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("订单状态")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.dstateInfo))])])]),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("订单编号")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.serialNumber))])])])],2),e._v(" "),a("div",{staticClass:"order-info"},[e._v("\n        预约订单明细\n      ")]),e._v(" "),a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("预约时间")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.dHandler))])])]),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("预约费")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v("￥ "+e._s(e.orderData.reserveFee))])])])]),e._v(" "),0!=e.orderData.payChannelReserve?a("div",{staticClass:"order-info"},[e._v("\n        预约支付明细\n      ")]):e._e(),e._v(" "),0!=e.orderData.payChannelReserve?a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("支付方式")]),e._v(" "),a("span",{staticClass:"ta-info"},[1===e.orderData.payChannelReserve?a("span",[e._v("\n                支付宝：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):2===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):3===e.orderData.payChannelReserve?a("span",[e._v("\n                现金：￥ "+e._s(e.orderData.reserveFee)+"\n              ")]):4===e.orderData.payChannelReserve?a("span",[e._v("\n                优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n              ")]):5===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):6===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):e._e()])])])]):e._e()])]),e._v(" "),a("div",{staticClass:"btnbgc"},[e.orderData.lockId?a("div",[a("div",{staticClass:"cancel p-a t-c"},[a("div",{staticClass:"canle-style",on:{click:e.cancelOrder}},[e._v("取消预约")]),e._v(" "),a("div",{staticClass:"item2-sytle",on:{click:e.lockModel}},[e._v("控制车锁")])])]):a("div",[a("div",{staticClass:"off-order p-a t-c",on:{click:e.cancelOrder}},[e._v("取消预约")])])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.islockshow,expression:"islockshow"}],staticClass:"alert-index",on:{click:e.closeModel}},[a("div",{staticClass:"al-info",on:{click:e.closeCs}},[a("div",{staticClass:"al-header"},[e._v("控制车锁")]),e._v(" "),a("div",{staticClass:"al-conter"},[a("div",{staticClass:"lock-img"},[a("div",{staticClass:"lock-up lock-wh",on:{click:function(t){e.lockEvnet(1)}}})]),e._v(" "),a("div",{staticClass:"lock-img"},[a("div",{staticClass:"lock-down lock-wh",on:{click:function(t){e.lockEvnet(2)}}})])]),e._v(" "),a("div",{staticClass:"al-header",on:{click:e.closeModel}},[e._v("关闭")])])]),e._v(" "),a("div",{staticStyle:{display:"none"},attrs:{id:"gdAMp"}})])},staticRenderFns:[]};var Z=a("VU/8")(U,Y,!1,function(e){a("de84")},null,null).exports,J=a("bOdI"),z=a.n(J),Q=a("162o"),W={name:"reservationBookingUnpaid",data:function(){return z()({headerMark:"预约详情",orderId:"",estateName:"",startTime:"",plateNo:"",createTime:"",createFmTime:"",endTime:"",address:"",hour:"00",minutes:"00",seconds:"00",miliSeconds:"00",interval:"",orgX:"",orgY:"",desX:"",desY:"",orderData:{},countdown:null,islockshow:!1,seconds1302:"00",minutes1302:"00",hours1302:"00",AMAP:null,lockId:null,totalFee:null,parklotId:null},"createTime",null)},components:{},computed:{},methods:{_initScroll:function(){var e=this;this.$nextTick(function(){e.scroll?e.scroll.refresh():e.scroll=new w.a(e.$refs.appoitInfoBox,{probeType:3,scrollY:!0,click:!0})})},getOrder:function(){var e=this;return b()(I.a.mark(function t(){var a,s;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=window.localStorage.getItem("orderId"),t.next=3,H(a);case 3:s=t.sent,console.log(s),2e3===s.error_code?(e.lockId=null,e.desX=s.data.lng,e.desY=s.data.lat,e.lockId=s.data.lockId,e.parklotId=s.data.parklotId,e.dispoceOrderDat(s.data),e.createTime=s.data.createTime,e.orderData=s.data,localStorage.setItem("H5_fees",s.data.reserveFee),window.localStorage.setItem("myParklotId",s.data.parklotId)):console.log(s,"错误码是"+s.error_message);case 6:case"end":return t.stop()}},t,e)}))()},dispoceOrderDat:function(e){var t=0;if(null===e.reserveCouponFee)t=e.reserveFee;else{var a;t=(a=e.reserveFee-e.reserveCouponFee)<=0?0:a}this.$set(e,"zpayReserve",t);var s=y(e.startTime),i=y(e.endTime);if(e.dHandler=s.substr(5,11)+" 至 "+i.substr(5,11),null===e.enterTime)e.enterTime="————";else{var n=y(e.enterTime);e.enterTime=n.substr(0,16)}if(null===e.leaveTime)e.leaveTime="————";else{var r=y(e.leaveTime);e.leaveTime=r.substr(0,16)}if(this.countdown=e.enterCountdownTime,this.downCounts(),null!==e.overTime){var o=parseInt(e.overTime%864e5/36e5),l=parseInt(e.overTime%36e5/6e4),c=e.overTime%6e4/1e3;e.overTime=o+":"+l+":"+c}if(1300===e.state?e.dstateInfo="未支付":1301===e.state?e.dstateInfo="已预约":1302===e.state?e.dstateInfo="停车中":1303===e.state?e.dstateInfo="离场未支付":1304===e.state?e.dstateInfo="已支付":1309===e.state?e.dstateInfo="已取消":1308!==e.state&&1307!==item.state&&1310!==item.state||(e.dstateInfo="超时已取消"),1302===e.state){var d=e.stopTime;this.addTime(d)}},addTime:function(e){var t=this;console.log(e);var a=parseInt(e/36e5),s=parseInt(e%36e5/6e4),i=parseInt(e%6e4/1e3);console.log(a,s,i),clearInterval(n);var n=Object(Q.setInterval)(function(){59===++i&&(i=0,s++),59===s&&(a++,s=0),s+="",a+="",1===(i+="").length&&(i="0"+i),1===s.length&&(s="0"+s),1===a.length&&(a="0"+a),t.seconds1302=i,t.minutes1302=s,t.hours1302=a,"00"==t.seconds1302&&"00"==t.minutes1302&&"00"==t.hours1302&&clearInterval(n)},1e3)},lockModel:function(){this.islockshow=!0},closeModel:function(){this.islockshow=!1},closeCs:function(e){e.cancelBubble=!0},lockEvnet:function(e){this.lockDown(e)},lockDown:function(e){var t=this;return b()(I.a.mark(function a(){var s;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.lockId=2,a.next=3,P(t.lockId,e);case 3:s=a.sent,console.log(s);case 5:case"end":return a.stop()}},a,t)}))()},downCounts:function(){var e=this,t=0,a=0,s=0;console.log(this.countdown),t=parseInt(this.countdown%864e5/36e5),a=parseInt(this.countdown%36e5/6e4),s=parseInt(this.countdown%6e4/1e3),console.log(t,a,s),t<=0&&a<=0&&s<=0||(null!=this.interval&&clearInterval(this.interval),this.interval=Object(Q.setInterval)(function(){--s<0&&(s=59,a--),s<0&&(a=59,t--),t<0&&(t=0),0==t&&0==a&&0==s&&(clearInterval(e.interval),e.$router.push("appointment")),t+="",s+="",1===(a+="").length&&(a="0"+a),1===s.length&&(s="0"+s),1===t.length&&(t="0"+t),e.hour=t,e.minutes=a,e.seconds=s},1e3))},cancelOrder:function(){var e=this;this.orderData.freeCancellationTime;n.MessageBox.confirm("",{title:"提示",message:'\n              <div class="ordermessage-info">\n                <div class="is-text">\n                  是否取消预约？\n                </div>\n              </div>',confirmButtonText:"取消预约",cancelButtonText:"保留预约",closeOnClickModal:!1}).then(function(t){e.cancelAppoint()}).catch(function(e){})},cancelAppoint:function(){var e=this;return b()(I.a.mark(function t(){return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R(e.orderId);case 2:2e3===t.sent.error_code?e.$router.push("reservationOld"):(Object(n.Toast)("页面超时。。。。"),e.getOrder());case 4:case"end":return t.stop()}},t,e)}))()},payGo:function(){var e=this;if(+(new Date).getTime()-this.createTime>=3e5){return n.MessageBox.confirm("",{title:"提示",message:'\n              <div class="ordermessage-info">\n                <div class="is-text">\n                  支付超时\n                </div>\n              </div>',closeOnClickModal:!1}).then(function(t){e.$router.push("reservationOld")}).catch(function(t){e.$router.push("reservationOld")}),!1}var t=window.localStorage.getItem("orderId");this.$router.push({name:"payMentDt",params:{fees:localStorage.getItem("H5_fees"),orderId:t}})}},created:function(){this._initScroll();var e=this;document.addEventListener("visibilitychange",function(){"visible"==document.visibilityState&&(e.seconds1302="00",e.minutes1302="00",e.hours1302="00",e.hour="00",e.minutes="00",e.seconds="00",e.getOrder())});var t=JSON.parse(localStorage.getItem("H5_geoLocation"));this.orgX=t.lng,this.orgY=t.lat},activated:function(){this.orderId=JSON.parse(localStorage.getItem("orderId")),this.getOrder()},mounted:function(){},beforeRouteLeave:function(e,t,a){n.MessageBox.close(!1),a()},watch:{$route:function(e,t){n.MessageBox.close(!1)}}},V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"appoint-info"}},[a("div",{ref:"appoitInfoBox",staticClass:"appoit-info-box"},[a("div",{attrs:{sytle:"position: relative;"}},[a("div",{staticClass:"content"},[2===e.orderData.type?a("div",{staticClass:"guide-show"},[a("div",{staticClass:"imgstyle"},[a("div",{staticClass:"img-car-text"},[2===e.orderData.type?a("span",[a("span",{staticClass:"border-text"},[e._v("车位")]),a("span",[e._v("编号")])]):e._e()]),e._v(" "),a("div",{staticClass:"car-ploate"},[2===e.orderData.type&&null!==e.orderData.parklocNumber?a("div",[e._v("\n                "+e._s(e.orderData.parklocNumber)+"\n              ")]):e._e()])])]):e._e(),e._v(" "),a("div",{staticClass:"plate"},[a("div",{staticClass:"plate-info"},[a("p",[a("span",{staticClass:"name-text"},[e._v(e._s(e.orderData.parklotName))]),e._v(" "),0===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室内")]):1===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室外")]):2===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室内+室外")]):e._e()])]),e._v(" "),a("div",{staticClass:"plate-content"},[e._v("\n            "+e._s(e.orderData.address)+"\n          ")])])]),e._v(" "),a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("订单状态")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.dstateInfo))])])]),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("订单编号")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.serialNumber))])])])]),e._v(" "),a("div",{staticClass:"order-info"},[e._v("\n        预约订单明细\n      ")]),e._v(" "),a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("预约时间")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.dHandler))])])]),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("预约费")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v("￥ "+e._s(e.orderData.reserveFee))])])])])])]),e._v(" "),a("div",{staticClass:"cancel p-a t-c"},[1===e.orderData.type||2===e.orderData.type?a("div",{staticClass:"cancel-order p-a t-c",on:{click:e.cancelOrder}},[e._v("取消预约")]):e._e(),e._v(" "),a("div",{staticClass:"item2-sytle",on:{click:e.payGo}},[e._v("立即支付")])])])},staticRenderFns:[]};var K=a("VU/8")(W,V,!1,function(e){a("V+Cx")},null,null).exports,X={name:"reservationInfo",data:function(){return{headerMark:"预约详情",orderId:"",estateName:"",startTime:"",plateNo:"",createTime:"",createFmTime:"",endTime:"",address:"",orderData:{},islockshow:!1,lockId:null,network:!0}},components:{subHeader:_},methods:{_initScroll:function(){var e=this;this.$nextTick(function(){e.scroll?e.scroll.refresh():e.scroll=new w.a(e.$refs.appoitInfoBox,{probeType:3,scrollY:!0,click:!0})})},getOrder:function(){var e=this;return b()(I.a.mark(function t(){var a,s;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=window.localStorage.getItem("orderId"),t.next=3,H(a);case 3:2e3===(s=t.sent).error_code?(e.lockId=null,e.desX=s.data.lng,e.desY=s.data.lat,e.lockId=s.data.lockId,e.dispoceOrderDat(s.data),e.orderData=s.data,e.parklotId=s.data.parklotId):console.log(s,"错误码是"+s.error_code);case 5:case"end":return t.stop()}},t,e)}))()},dispoceOrderDat:function(e){var t=0;if(null===e.reserveCouponFee)t=e.reserveFee;else{var a;t=(a=(e.reserveFee-e.reserveCouponFee).toFixed(2))<=0?0:a}this.$set(e,"zpayReserve",t);var s=0;if(null===e.parkingCouponFee)s=e.parkingFee;else{var i;s=(i=(e.parkingFee-e.parkingCouponFee).toFixed(2))<=0?0:i}this.$set(e,"zpayParking",s);var n=y(e.startTime),r=y(e.endTime);if(e.dHandler=n.substr(5,11)+" 至 "+r.substr(5,11),null===e.enterTime)e.enterTime="————";else{var o=y(e.enterTime);e.enterTime=o.substr(0,16)}if(null===e.leaveTime)e.leaveTime="————";else{var l=y(e.leaveTime);e.leaveTime=l.substr(0,16)}if(this.countdown=e.enterCountdownTime,null!==e.overTime){var c=parseInt(e.overTime%864e5/36e5),d=parseInt(e.overTime%36e5/6e4),u=e.overTime%6e4/1e3;e.overTime=c+":"+d+":"+u}if(1300===e.state?e.dstateInfo="未支付":1301===e.state?e.dstateInfo="已预约":1302===e.state?e.dstateInfo="停车中":1303===e.state?e.dstateInfo="离场未支付":1304===e.state?e.dstateInfo="已完成":1309===e.state?e.dstateInfo="已取消":1308!==e.state&&1307!==item.state&&1310!==item.state||(e.dstateInfo="超时已取消"),1302===e.state)e.stopTime}},created:function(){this._initScroll()},activated:function(){this.getOrder()}},q={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"appoint-info"}},[a("div",{ref:"appoitInfoBox",staticClass:"appoit-info-box"},[a("div",{attrs:{sytle:"position: relative;"}},[a("div",{staticClass:"content"},[2===e.orderData.type?a("div",{staticClass:"guide-show"},[a("div",{staticClass:"imgstyle"},[a("div",{staticClass:"img-car-text"},[2===e.orderData.type?a("span",[a("span",{staticClass:"border-text"},[e._v("车位")]),a("span",[e._v("编号")])]):e._e()]),e._v(" "),a("div",{staticClass:"car-ploate"},[null!==e.orderData.parklocNumber?a("div",[e._v("\n                "+e._s(e.orderData.parklocNumber)+"\n              ")]):e._e()])])]):e._e(),e._v(" "),a("div",{staticClass:"plate"},[a("div",{staticClass:"plate-info"},[a("p",[a("span",{staticClass:"name-text"},[e._v(e._s(e.orderData.parklotName))]),e._v(" "),0===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室内")]):1===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室外")]):2===e.orderData.parklotKind?a("span",{staticClass:"yellow-s"},[e._v("室内+室外")]):e._e()]),e._v(" "),e.orderData.parkingFee?a("p",{attrs:{calss:"red"}},[e._v("\n                  ￥"+e._s(e.orderData.parkingFee)+"\n              ")]):e.orderData.reserveFee?a("p",{attrs:{calss:"red"}},[e._v("\n                  ￥"+e._s(e.orderData.reserveFee)+"\n              ")]):a("p",{attrs:{calss:"red"}})]),e._v(" "),a("div",{staticClass:"plate-content"},[e._v("\n            "+e._s(e.orderData.address)+"\n          ")])])]),e._v(" "),a("div",{staticClass:"plate-card"},[1301===e.orderData.state?[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("入场时间")]),e._v(" "),a("div",{staticClass:"time-add"},[a("div",{staticClass:"time-style"},[e._v(e._s(e.hour))]),e._v(" "),a("div",{staticClass:"time-text"},[e._v("时")]),e._v(" "),a("div",{staticClass:"time-style"},[e._v(e._s(e.minutes))]),e._v(" "),a("div",{staticClass:"time-text"},[e._v("分")]),e._v(" "),a("div",{staticClass:"time-style"},[e._v(e._s(e.seconds))])])])])]:e._e(),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("订单状态")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.dstateInfo))])])]),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("订单编号")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.serialNumber))])])])],2),e._v(" "),a("div",{staticClass:"order-info"},[e._v("\n        预约订单明细\n      ")]),e._v(" "),a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("预约时间")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.dHandler))])])]),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("预约费")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v("￥ "+e._s(e.orderData.reserveFee))])])])]),e._v(" "),e.orderData.payChannelReserve?a("div",{staticClass:"order-info"},[e._v("\n        预约支付明细\n      ")]):e._e(),e._v(" "),e.orderData.payChannelReserve?a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("支付方式")]),e._v(" "),a("span",{staticClass:"ta-info"},[1===e.orderData.payChannelReserve?a("span",[e._v("\n                支付宝：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):2===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):3===e.orderData.payChannelReserve?a("span",[e._v("\n                现金：￥ "+e._s(e.orderData.reserveFee)+"\n              ")]):4===e.orderData.payChannelReserve?a("span",[e._v("\n                优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n              ")]):5===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):6===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):e._e()])])]),e._v(" "),null!=e.orderData.reserveTradeNo?a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("支付流水号")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.reserveTradeNo))])])]):e._e(),e._v(" "),null!==e.orderData.reserveCouponCode?a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("优惠券编号")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.reserveCouponCode))])])]):e._e()]):e._e(),e._v(" "),1309!=e.orderData.state&&1308!=e.orderData.state?a("div",{staticClass:"order-info"},[e._v("\n          停车订单明细\n      ")]):e._e(),e._v(" "),1309!=e.orderData.state&&1308!=e.orderData.state?a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("入场时间")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.enterTime))])])]),e._v(" "),a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("离场时间")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.leaveTime))])])]),e._v(" "),null!==e.orderData.overTime?a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("超时时长")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.overTime))])])]):e._e(),e._v(" "),null!==e.orderData.parkingFee?a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("停车费")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v("￥"+e._s(e.orderData.parkingFee))])])]):e._e(),e._v(" "),0!==e.orderData.overTimeFee?a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("超时金额")]),e._v(" "),a("span",{staticClass:"ta-info red"},[e._v("￥"+e._s(e.orderData.overTimeFee))])])]):e._e()]):e._e(),e._v(" "),1309!=e.orderData.state&&1308!=e.orderData.state?a("div",{staticClass:"order-info lastOne"},[e._v("\n          停车支付明细\n      ")]):e._e(),e._v(" "),1309!=e.orderData.state&&1308!=e.orderData.state?a("div",{staticClass:"plate-card"},[a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("支付方式")]),e._v(" "),a("span",{staticClass:"ta-info"},[1===e.orderData.payChannelReserve?a("span",[e._v("\n                支付宝：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):2===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):3===e.orderData.payChannelReserve?a("span",[e._v("\n                现金：￥ "+e._s(e.orderData.reserveFee)+"\n              ")]):4===e.orderData.payChannelReserve?a("span",[e._v("\n                优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n              ")]):5===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):6===e.orderData.payChannelReserve?a("span",[e._v("\n                微信：￥ "+e._s(e.orderData.zpayReserve)+"\n                "),null!==e.orderData.reserveCouponFee?a("span",[e._v("\n                  优惠券：￥ "+e._s(e.orderData.reserveCouponFee)+"\n                ")]):e._e()]):e._e()])])]),e._v(" "),e.orderData.parkingTradeNo?a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("支付流水号")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.parkingTradeNo))])])]):e._e(),e._v(" "),null!==e.orderData.parkingCouponCode?a("div",{staticClass:"p-message"},[a("div",{staticClass:"time-info"},[a("span",{staticClass:"name-text"},[e._v("优惠券编号")]),e._v(" "),a("span",{staticClass:"ta-info"},[e._v(e._s(e.orderData.parkingCouponCode))])])]):e._e()]):e._e()])])])},staticRenderFns:[]};var ee=a("VU/8")(X,q,!1,function(e){a("eMi9")},null,null).exports,te=a("i5La"),ae=a.n(te),se={data:function(){return{plateNo:"",plateNoId:"",show1:!1,isshow:!1,headerMark:"预约",pointedItem:{},carPlate:null,startTime:"",endTime:"",fmEndTime:"",estateId:"",mytime:"",parklotId:null,userId:null,allTime:[],pickerVisible:null,reserveTimeList:[],feeList:[],pickData2:{columns:2,link:!0,default:[],pData1:[],pData2:{}},nowTime:null,timeList:[],arr:[],array:[],arrayflag:!1,defaultTime:"00:00",leaveTime:null,priceTime:null,price:0,parkItemObj:{},params:{user_id:null,parklot_id:null,plate_id:null,share_startTime:null,share_endTime:null,start_time:null,end_time:null},systemTime:null,systemTimeFlag:!1}},components:{subHeader:_,VuePickers:ae.a},methods:{closeZinde:function(){this.isshow=!1,this.show1=!1},_initScroll:function(){var e=this;this.$nextTick(function(){e.leftScroll?e.leftScroll.refresh():e.leftScroll=new w.a(e.$refs.apponitBox,{probeType:3,scrollY:!0,click:!0})})},getparklot:function(){var e=this;return b()(I.a.mark(function t(){var a,s;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.userId=JSON.parse(localStorage.getItem("userId")),e.parklotId=JSON.parse(localStorage.getItem("myParklotId")),e.reserveTimeList=[],t.next=5,B(e.userId,e.parklotId);case 5:2e3===(a=t.sent).error_code?(console.log(a),e.pointedItem=a.data,e.params.plate_id=e.pointedItem.plateId,e.params.parklot_id=e.pointedItem.parklotId,(s=JSON.parse(localStorage.getItem("H5_chosen_plate")))?(e.plateNo=s.plateNo,e.plateNoId=s.plateNoId,localStorage.removeItem("H5_chosen_plate")):(e.plateNo=a.data.plateNo,e.plateNoId=a.data.plateId),e.parkItemObj.id=a.data.parklotId,e.feeList=e.pointedItem.feeList,e.reserveTimeList=e.pointedItem.reserveTimeList,e.reserveTimeList.length?(e.filterTime(e.pointedItem.reserveTimeList),e.disposeTime(e.timeList),e.dataChange()):e.messInfo(),e._initScroll()):Object(n.Toast)({message:"获取预约信息失败",duration:1500});case 7:case"end":return t.stop()}},t,e)}))()},messInfo:function(){var e=this;Object(n.MessageBox)({title:"温馨提示",message:'\n                      <div class="appointmessage-info">\n                        <div class="is-text">车位已经被预约满了。</div>\n                      </div>',showConfirmButton:!0,confirmButtonText:"确认",showCancelButton:!1}).then(function(t){n.Indicator.open(),Object(Q.setTimeout)(function(){n.Indicator.close(),e.getparklot()},2e3)}).catch(function(e){})},filterTime:function(e){for(var t=0;t<e.length;t++)if(e[t].startTime>=this.nowTime){if(e[t].startTime>e[t].endTime-9e5)continue;this.timeList.push({startTime:e[t].startTime,endTime:e[t].endTime,id:e[t].id})}else{if(e[t].startTime<this.nowTime&&e[t].endTime<this.nowTime)continue;e[t].startTime<this.nowTime&&this.nowTime<e[t].endTime-9e5&&this.timeList.push({startTime:e[t].startTime,endTime:e[t].endTime,id:e[t].id})}},disposeTime:function(e){for(var t=0;t<this.timeList.length;t++)this.timeList[t].endTime-=9e5;var a=[],s=e[0];if(e.length<=1)this.timeList=[].concat(e);else{for(var i=1;i<e.length;i++){var n={},r=e[i];s.endTime>=r.startTime&&r.endTime>=s.endTime?(n.startTime=s.startTime,n.endTime=r.endTime,i>0&&a.pop(a[length-1]),a.push(n),s.startTime=n.startTime,s.endTime=n.endTime,!0):s.endTime>=r.startTime&&r.endTime<s.endTime?(n.startTime=s.startTime,n.endTime=s.endTime,i>0&&a.pop(a[length-1]),a.push(n),s.startTime=n.startTime,n.endTime=s.endTime,!0):(a.push(r),s.startTime=r.startTime,s.endTime=r.endTime)}this.timeList=[].concat(a)}},dataChange:function(){for(var e=0;e<this.timeList.length;e++){var t=this.timeList[e];this.array=[];var a=(t.endTime-t.startTime)/9e5;if(!(this.nowTime>t.endTime))if(t.startTime<this.nowTime&&this.nowTime<t.endTime){var s=null,i=t.startTime,n=[];this.arrayflag=!0;for(var r=0;r<=a;r++)n.push(i),i+=9e5;for(var o=0;o<n.length;o++)if(this.nowTime<n[o]){s=o;break}var l=[];null!==s&&(l=n.slice(s),this.array.push(l))}else{for(n=[],i=this.timeList[e].startTime,r=0;r<=a;r++)n.push(i),i+=9e5;this.array.push(n)}}this.convertTime()},convertTime:function(){for(var e=[],t={},a=[],s=0;s<this.array.length;s++)for(var i=this.array[s],n=y(i[0]).substr(8,2),r=0;r<i.length;r++){var o=y(i[r]),l=o.substr(14,2),c=o.substr(11,2);n<o.substr(8,2)?(c=" 次日 "+c+" 时 ",l+=" 分 "):(c+=" 时 ",l+=" 分 "),e.length>=1?e[e.length-1].texts!=c&&e.push({text:c,value:s+r+c,texts:c,time:i[r]}):e.push({text:c,value:s+r+c,texts:c,time:i[r]}),a.push({text:l,value:s+r,texts:c,time:i[r]}),o.substr(11,2)}var d=e,u=this.pData2chang(a);for(s=0;s<d.length;s++)t[d[s].value]=u[d[s].text];this.$set(this.pickData2,"pData1",d),this.$set(this.pickData2,"pData2",t),this.pickData2.default.push(d[0]),this.pickData2.default.push(t[d[0].value][0]),this.defaultTime=d[0].text.substring(0,d[0].text.length-2)+":"+t[d[0].value][0].text.substring(0,t[d[0].value][0].text.length-2)+"前",this.params.start_time=this.params.startTime,this.priceTime=d[0].time-(new Date).getTime(),this.getPrice(this.priceTime),this.getDefaultTime(d[0].time)},getMyDate:function(e){var t=new Date(e),a=t.getHours(),s=t.getMinutes();return new String(a).length<=1&&(a="0"+a),new String(s).length<=1&&(s="0"+s),a+":"+s},pData2chang:function(e){for(var t=[],a=0;a<e.length;a++)if(t[e[a].texts])t[e[a].texts].push(e[a]);else{var s=[];s.push(e[a]),t[e[a].texts]=s}return t},getDefaultTime:function(e){for(var t=e,a=[],s=0;s<this.reserveTimeList.length;s++)this.reserveTimeList[s].startTime<=t&&t<=this.reserveTimeList[s].endTime-9e5&&a.push({learve:this.reserveTimeList[s],times:this.reserveTimeList[s].endTime-t});if(1===a.length){this.params.shareStartTime=a[0].learve.startTime,this.params.shareEndTime=this.params.endTime=a[0].learve.endTime,this.params.startTime=t;var i=0!=(u=y(a[0].learve.endTime)).substr(5,1)?u.substr(5,2):u.substr(6,1),n=0!=u.substr(8,1)?u.substr(8,2):u.substr(9,1),r=u.substr(14,2),o=u.substr(11,2);this.leaveTime=i+"月"+n+"日"+o+":"+r+":00"}else{var l=a[0].times,c=a.length,d=a[0];for(s=1;s<c;s++)a[s].times>l&&(l=a[s].times,d=a[s]);var u;i=0!=(u=y(d.learve.endTime)).substr(5,1)?u.substr(5,2):u.substr(6,1),n=0!=u.substr(8,1)?u.substr(8,2):u.substr(9,1),r=u.substr(14,2),o=u.substr(11,2);this.leaveTime=i+"月"+n+"日"+o+":"+r+":00",this.params.shareStartTime=d.learve.startTime,this.params.shareEndTime=this.params.endTime=d.learve.endTime,this.params.startTime=t}},getPrice:function(e){for(var t=null,a=parseInt(e/6e4),s=0;s<this.feeList.length;s++)if(a<=this.feeList[s].finishTime){t=s;break}s===this.feeList.length&&(t=s-1),this.feeList[t]&&(this.price=(this.feeList[t].fee*this.pointedItem.integralPermissionsCoefficient).toFixed(2))},openPicker:function(){this.$root.eventHub.$emit("init"),0!==this.reserveTimeList.length?(this.$root.eventHub.$emit("refer"),this.show1=!0,this.isshow=!0):Object(n.Toast)({message:"没有预约的时间段",duration:1500})},confirmFn:function(e){e.cancelBubble=!0,this.params.startTime=e.select2.time,this.params.start_time=e.select2.time,this.systemTimeFlag?this.priceTime=this.systemTime-(new Date).getTime():this.priceTime=e.select2.time-(new Date).getTime(),this.getPrice(this.priceTime),this.defaultTime=e.select1.text.substring(0,e.select1.text.length-2)+":"+e.select2.text.substring(0,e.select2.text.length-2)+"前",this.getDefaultTime(e.select2.time),this.show1=!1,this.isshow=!1},close:function(e){this.show1=!1,this.isshow=!1,e.cancelBubble=!0},doPay:function(e){var t=this;return b()(I.a.mark(function a(){var s,i,r,o,l;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="apiwrite/reserve/pay",i=null,r=null,o=null,l=1,a.next=7,E(s,e,l,i,r,o);case 7:2e3==a.sent.error_code?(Object(n.Toast)({message:"预约成功",duration:1500}),localStorage.setItem("routerFlag",null),t.$router.push("payToComplete")):Object(n.Toast)({message:"预约失败,请您重新预约",duration:1500});case 9:case"end":return a.stop()}},a,t)}))()},goApoint:function(){var e=this;return b()(I.a.mark(function t(){var a,s,i;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.params.user_id=localStorage.getItem("userId"),e.params.plate_id=e.plateNoId,e.plateNo&&""!=e.plateNo){t.next=5;break}return Object(n.Toast)({message:"请选择您的车牌号",duration:1500}),t.abrupt("return");case 5:if(e.timeList.length){t.next=8;break}return e.messInfo(),t.abrupt("return");case 8:return e.params.share_startTime=e.params.shareStartTime,e.params.share_endTime=e.params.shareEndTime,e.params.end_time=e.params.endTime,e.params.start_time&&null!=e.params.start_time||(e.params.start_time=e.params.startTime),t.next=14,(r=e.params).timestamp=(new Date).getTime(),r=p()(r),O("post",A+"apiwrite/reserve/confirm",r);case 14:if(2801!=(a=t.sent).error_code){t.next=20;break}n.Indicator.close(),Object(n.Toast)({message:"入场时间已过，请重新选择。",duration:1500}),t.next=54;break;case 20:if(2900!=a.error_code){t.next=25;break}n.Indicator.close(),Object(n.Toast)({message:"您还有订单未完成。",duration:1500}),t.next=54;break;case 25:if(2904!=a.error_code){t.next=30;break}n.Indicator.close(),Object(n.Toast)({message:"该车辆已存在预约订单。",duration:1500}),t.next=54;break;case 30:if(2905!=a.error_code){t.next=34;break}e.messInfo(),t.next=54;break;case 34:if(2906!=a.error_code){t.next=38;break}Object(n.Toast)({message:"您暂无预约资格，请联系物业管理员",duration:1500}),t.next=54;break;case 38:if(2e3!=a.error_code){t.next=48;break}n.Indicator.close(),s=a.data.orderId,i=a.data.totalFee,localStorage.setItem("orderId",s),localStorage.setItem("H5_fees",i),localStorage.setItem("goBackFlag","reservationOld"),0==i?e.doPay(s):(localStorage.setItem("routerFlag",null),e.$router.push({name:"payMentDt",params:{fees:i,orderId:s}})),t.next=54;break;case 48:if(2901!==a.error_code){t.next=53;break}return e.messInfo(),t.abrupt("return");case 53:Object(n.Toast)({message:a.error_message,duration:1500});case 54:case"end":return t.stop()}var r},t,e)}))()},chooseCar:function(){this.$router.push({name:"licensePlate",params:{from:"licensePlate"}})},timeToget:function(){var e=Number((new Date).getTime())+9e5;this.nowTime=e}},activated:function(){this.timeToget(),this.getparklot()},deactivated:function(){this.$destroy(!0)},beforeRouteLeave:function(e,t,a){this.plateNo="",n.MessageBox.close(!1),a()},beforeRouteEnter:function(e,t,a){a(function(e){"/car"===t.path&&(e.carPlate=JSON.parse(localStorage.getItem("H5_carplate")))})}},ie={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"appoint"}},[a("div",{ref:"apponitBox",staticClass:"content p-a"},[a("div",[a("div",{staticClass:"info car-info"},[a("div",{staticClass:"car-style"},[a("div",[a("div",{staticClass:"ic ic-font1"}),e._v(" "),a("span",{staticClass:"text"},[e._v(e._s(e.pointedItem.parklotName))]),e._v(" "),0===e.pointedItem.parklotKind?a("span",{staticClass:"cars-color"},[e._v("室内")]):1===e.pointedItem.parklotKind?a("span",{staticClass:"cars-color"},[e._v("室外")]):2===e.pointedItem.parklotKind?a("span",{staticClass:"cars-color"},[e._v("室内+室外")]):e._e()]),e._v(" "),a("div",{staticClass:"dis-2"},[a("span",{staticClass:"redNumber"},[e._v(e._s(e.pointedItem.reservableAmount))])])]),e._v(" "),a("div",{staticClass:"car-distance"},[a("div",{staticClass:"dis-inline"},[a("span",{staticClass:"text-distance"},[e._v(e._s(e.pointedItem.address))])]),e._v(" "),e._m(0)])]),e._v(" "),a("div",{staticClass:"info plate-number",on:{click:e.chooseCar}},[a("div",{staticClass:"text-3"},[e._v("车牌号")]),e._v(" "),a("div",{staticClass:"dis-2"},[a("span",{staticClass:"plate-info"},[e._v(e._s(e.plateNo))]),e._v(" "),e._v("\n            \n          "),a("div",{staticClass:"ic ic-style"})])]),e._v(" "),a("div",{staticClass:"info einlass plate-number"},[a("div",{staticClass:"text-3"},[e._v("入场时间")]),e._v(" "),a("div",{staticClass:"dis-2",on:{click:e.openPicker}},[a("div",[e._v(e._s(e.defaultTime))]),e._v("\n            \n          "),a("div",{staticClass:"ic ic-style"})])]),e._v(" "),a("div",{staticClass:"info stop-time"},[a("div",{staticClass:"text-3"},[e._v("可停至")]),e._v(" "),a("div",{staticClass:"exprie"},[e._v(e._s(e.leaveTime))])])])]),e._v(" "),a("div",{staticClass:"to-appoint t-c"},[a("div",{staticClass:"div-flex"},[a("div",{staticClass:"div-style ds-1"},[e._v("\n        预约费 \n        "),a("span",{staticStyle:{color:"#f63372"}},[e._v("￥"),a("span",{staticClass:"price-style"},[e._v(e._s(e.price))])])]),e._v(" "),a("div",{staticClass:"div-style ds-2",on:{click:e.goApoint}},[e._v("立即预约")])])]),e._v(" "),a("div",{class:{alert:e.isshow},on:{click:e.closeZinde}}),e._v(" "),a("vue-pickers",{attrs:{show:e.show1,selectData:e.pickData2},on:{cancel:e.close,confirm:e.confirmFn}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"dis-inline"},[t("span",{staticClass:"black-location"},[this._v("空泊位")])])}]};var ne=a("VU/8")(se,ie,!1,function(e){a("hHfE")},null,null).exports,re=a("Gu7T"),oe=a.n(re),le=["粤","京","沪","津","冀","鲁","云","辽","黑","湘","皖","新","苏","浙","赣","鄂","桂","甘","晋","蒙","陕","吉","闽","贵","青","藏","川","宁","琼","豫","渝",null,null,null,null,null,null,null,null,"删"],ce=["1","2","3","4","5","6","7","8","9","0","Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","学","Z","X","C","V","B","N","M","港","澳","删"],de={name:"keyboard",data:function(){return{}},computed:{keyboardLists:function(){return this.showflag?le:ce}},props:{showflag:{type:Number,default:0}},created:function(){},methods:{getItem:function(e){var t=e.target.getAttribute("itemdata");this.$emit("getinput",t)},inputStart:function(e){e.currentTarget.style.backgroundColor="#d01d95",e.currentTarget.style.color="#fff"},inputEnd:function(e){e.currentTarget.style.backgroundColor="#fff",e.currentTarget.style.color="#1a1a1a"},hideKeyboard:function(){this.$emit("hiden")}}},ue={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"keyboard",attrs:{id:"keyboard",showflg:"1"}},[a("div",{staticClass:"keyboard-head",attrs:{showflg:"1"}},[a("span",{attrs:{showflg:"1"},on:{click:e.hideKeyboard}},[e._v("确定")])]),e._v(" "),a("div",{staticClass:"keyboard-lists",attrs:{showflg:"1"}},e._l(e.keyboardLists,function(t,s){return a("div",{key:s,staticClass:"keyboard-item",attrs:{showflg:"1"}},[a("div",{class:[{ban:"I"==t||"O"==t},{"iconfont icon-delete":"删"===t}],attrs:{itemdata:t,showflg:"1"},on:{click:function(a){t&&"I"!=t&&"O"!=t&&e.getItem(a)},touchstart:function(a){"I"!=t&&"O"!=t&&e.inputStart(a)},touchend:function(a){"I"!=t&&"O"!=t&&e.inputEnd(a)}}},[e._v("\n        "+e._s("删"===t?"":t)+"\n        ")])])}))])},staticRenderFns:[]};var pe,ve=a("VU/8")(de,ue,!1,function(e){a("avfW")},"data-v-1b3387a8",null).exports,me=(a("OMJi"),pe={data:function(){return{plateNo:"",plateNoId:"",show1:!1,isshow:!1,plateNum:"",plateShowed:!1,proInfo:"粤",iniInfo:"B",cletoast:null,phoneNumber:null,code:"",codeBack:!1,randerCodes:"",codeCounts:0,isGettingCodes:!1,getCodeFlag:!1,phoneList:null,phoneArr:null,isclosecode:!1,isclosephone:!1,iscodeplugin:!1,error_code:null,anti:1,identifyCodes:"1234567890",identifyCode:"",pointedItem:{},carPlate:null,startTime:"",endTime:"",fmEndTime:"",estateId:"",mytime:"",parkLotId:null,allTime:[],pickerVisible:null,reserveTimeList:[],feeList:[],pickData2:{columns:2,link:!0,default:[],pData1:[],pData2:{}},nowTime:null,timeList:[],arr:[],array:[],arrayflag:!1,defaultTime:"00:00",leaveTime:null,priceTime:null,price:0,parkItemObj:{},params:{plateNumber:null,phone:null,startTime:null,endTime:null,shareStartTime:null,shareEndTime:null,totalFee:null,parklotId:null,ip:null,phoneModel:null,unionId:null,openId:null,timestamp:null,userId:null},counts:"",systemTime:null,systemTimeFlag:!1,pagechange:!1,getSecond:null,KeyBoardflag:0,show:0,indentLists:["粤","B"],plateLists:["车","牌","号","码",null,null,null],isPlateFlag:!0,cursorFlag:!1,currentPlateIndex:0,maxIndex:5,currentIndentIndex:null,clickFlag:!0}},computed:{getCodeInfo:function(){return this.isGettingCodes?this.counts:"获取验证码"},savetyConfirmShowed:function(){return!1}},components:{VuePickers:ae.a,KeyBoard:ve},methods:{hiddenJp:function(e){"1"!=e.target.getAttribute("showflg")&&(this.show=!1)},handleInput:function(){document.documentElement.clientHeight<this.windowHeight?(this.$refs.hiddenBtn.style.display="none",console.log("执行")):this.$refs.hiddenBtn.style.display="block"},getkeyboard:function(e){if(this.isPlateFlag)"删"===e?this.delPlate(e):this.inputPlate(e);else{if("删"===e)return!1;this.inputIndent(e)}},hideKey:function(){this.show=!1},showKey:function(){this.KeyBoardflag=0,this.show=!0,this.isPlateFlag=!0,this.cursorFlag=!0,this.currentIndentIndex=null},inputPlate:function(e){var t=this,a=t.currentPlateIndex;t.cursorFlag=!0,0===a&&(t.plateLists=[null,null,null,null,null,null,null]);var s=[].concat(oe()(t.plateLists));a<=t.maxIndex&&(s[a]=e,t.plateLists=s,a++,t.currentPlateIndex=a)},delPlate:function(e){var t=this,a=t.currentPlateIndex;if(0===a)return!1;if(--a,t.currentPlateIndex=a,0===a)t.plateLists=["车","牌","号","码",null,null];else{var s=[].concat(oe()(t.plateLists));s[a]=null,t.plateLists=s}},inputIndent:function(e){var t=this,a=[].concat(oe()(t.indentLists)),s=t.currentIndentIndex;a[s]=e,t.indentLists=a,1===s?(t.isPlateFlag=!0,t.cursorFlag=!0,t.currentIndentIndex=null):(t.currentIndentIndex=1,t.KeyBoardflag=0)},changeInput:function(e){var t=this,a=Number(e.target.getAttribute("inde"));t.isPlateFlag=!1,t.cursorFlag=!1,t.show=!0,t.currentIndentIndex=a,t.KeyBoardflag=0===a?1:0},getItem:function(e){this.phoneNumber=e,this.phoneArr=null},isHideen:function(){this.$root.eventHub.$emit("showK",null)},closeZinde:function(){this.isshow=!1,this.show1=!1},_initScroll:function(){var e=this;this.$nextTick(function(){e.leftScroll?e.leftScroll.refresh():e.leftScroll=new w.a(e.$refs.apponitBox,{probeType:3,scrollY:!0,click:!0})})},getparklot:function(){var e=this;return b()(I.a.mark(function t(){var a,s,i;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=null,e.parkLotId=localStorage.getItem("myParklotId"),e.reserveTimeList=[],t.next=5,B(a,e.parkLotId);case 5:2e3===(s=t.sent).error_code?(e.pointedItem=s.data,e.params.parklotId=e.pointedItem.parklotId,(i=JSON.parse(localStorage.getItem("H5_chosen_plate")))?(e.plateNo=i.plateNo,e.plateNoId=i.plateNoId,localStorage.removeItem("H5_chosen_plate")):(e.plateNo=s.data.plateNo,e.plateNoId=s.data.plateId),e.parkItemObj.id=s.data.parklotId,e.feeList=e.pointedItem.feeList,e.reserveTimeList=e.pointedItem.reserveTimeList,e.reserveTimeList.length?(e.filterTime(e.pointedItem.reserveTimeList),e.disposeTime(e.timeList),e.dataChange()):e.messInfo(),e._initScroll()):Object(n.Toast)({message:"获取预约信息失败",duration:1500});case 7:case"end":return t.stop()}},t,e)}))()},messInfo:function(){var e=this;Object(n.MessageBox)({title:"温馨提示",message:'\n                      <div class="appointmessage-info">\n                        <div class="is-text">车位已经被预约满了。</div>\n                      </div>',showConfirmButton:!0,confirmButtonText:"确认",showCancelButton:!1}).then(function(t){n.Indicator.open(),setTimeout(function(){n.Indicator.close(),e.getparklot()},2e3)}).catch(function(e){})},filterTime:function(e){for(var t=0;t<e.length;t++)if(e[t].startTime>=this.nowTime){if(e[t].startTime>e[t].endTime-9e5)continue;this.timeList.push({startTime:e[t].startTime,endTime:e[t].endTime,id:e[t].id})}else{if(e[t].startTime<this.nowTime&&e[t].endTime<this.nowTime)continue;e[t].startTime<this.nowTime&&this.nowTime<e[t].endTime-9e5&&this.timeList.push({startTime:e[t].startTime,endTime:e[t].endTime,id:e[t].id})}},disposeTime:function(e){for(var t=0;t<this.timeList.length;t++)this.timeList[t].endTime-=9e5;var a=[],s=e[0];if(e.length<=1)this.timeList=[].concat(e);else{for(var i=1;i<e.length;i++){var n={},r=e[i];s.endTime>=r.startTime&&r.endTime>=s.endTime?(n.startTime=s.startTime,n.endTime=r.endTime,i>0&&a.pop(a[length-1]),a.push(n),s.startTime=n.startTime,s.endTime=n.endTime,!0):s.endTime>=r.startTime&&r.endTime<s.endTime?(n.startTime=s.startTime,n.endTime=s.endTime,i>0&&a.pop(a[length-1]),a.push(n),s.startTime=n.startTime,n.endTime=s.endTime,!0):(a.push(r),s.startTime=r.startTime,s.endTime=r.endTime)}this.timeList=[].concat(a)}},getPhoneList:function(){var e=this.phoneNumber.trim();e.length>11&&(this.phoneNumber=e.substr(0,11)),null!==this.phoneNumber&&""!==this.phoneNumber?this.isclosephone=!0:this.isclosephone=!1;var t=[],a=new RegExp("^"+this.phoneNumber);if(null!==this.phoneList){for(var s=0;s<this.phoneList.length;s++)null!==this.phoneList[s].match(a)&&""!==this.phoneList[s].match(a)[0]&&t.push(this.phoneList[s]);this.phoneArr=t}},inputCodeEvent:function(){var e=this.code.trim();e.length>4&&(this.code=e.substr(0,4)),null===this.code||""===this.code?this.isclosecode=!1:this.isclosecode=!0},closeCode:function(){this.code=null,this.isclosecode=!1},closephone:function(){this.phoneNumber=null,this.phoneArr=null,this.isclosephone=!1},getCode:function(e){""!==this.phoneNumber&&null!==this.phoneNumber&&/^[1][3,4,5,7,8][0-9]{9}$/.test(this.phoneNumber.trim())?this.isGettingCodes||this.getCodeFlag||(this.timeCount(),this.sendRanderCodes()):Object(n.Toast)("请输入正确的手机号码")},timeCount:function(){var e=this,t=60;this.getCodeFlag=!0,document.addEventListener("visibilitychange",this.documentEvent),this.timer=setInterval(function(){e.isGettingCodes=!0,t--,e.pagechange&&(t-=e.getSecond),e.counts=t+"s",t<=0&&(t=0,console.log(1234),console.log(e.timer),clearInterval(e.timer),e.isGettingCodes=!1,e.getCodeFlag=!1)},1e3)},sendRanderCodes:function(){var e=this;return b()(I.a.mark(function t(){var a;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s=e.phoneNumber,i=e.anti,O("post",A+"apiwrite/system/verification/code/get",{phone:s,anti:i,timestamp:(new Date).getTime()});case 2:2004===(a=t.sent).error_code?(e.error_code=2004,e.iscodeplugin=!0,e.randerCodes=""):2e3===a.error_code?(e.randerCodes=a.data.code,e.iscodeplugin=!1):Object(n.Toast)("错误码是"+a.error_message);case 4:case"end":return t.stop()}var s,i},t,e)}))()},documentEvent:function(){if("visible"==document.visibilityState){var e=Date.parse(new Date),t=m("H5_lslogin_time");console.log(e-t);var a=e-t+"",s=a.substring(0,a.length-3);console.log(s),this.getSecond=s}else{console.log("关闭了");var i=Date.parse(new Date);v("H5_lslogin_time",i)}},dataChange:function(){for(var e=0;e<this.timeList.length;e++){var t=this.timeList[e];this.array=[];var a=(t.endTime-t.startTime)/9e5;if(!(this.nowTime>t.endTime))if(t.startTime<this.nowTime&&this.nowTime<t.endTime){var s=null,i=t.startTime,n=[];this.arrayflag=!0;for(var r=0;r<=a;r++)n.push(i),i+=9e5;for(var o=0;o<n.length;o++)if(this.nowTime<n[o]){s=o;break}var l=[];null!==s&&(l=n.slice(s),this.array.push(l))}else{for(n=[],i=this.timeList[e].startTime,r=0;r<=a;r++)n.push(i),i+=9e5;this.array.push(n)}}this.convertTime()},convertTime:function(){var e=[],t={},a=[];console.log(this.array);for(var s=0;s<this.array.length;s++)for(var i=this.array[s],n=y(i[0]).substr(8,2),r=0;r<i.length;r++){var o=y(i[r]),l=o.substr(14,2),c=o.substr(11,2);n<o.substr(8,2)?(c=" 次日 "+c+" 时 ",l+=" 分 "):(c+=" 时 ",l+=" 分 "),e.length>=1?e[e.length-1].texts!=c&&e.push({text:c,value:s+r+c,texts:c,time:i[r]}):e.push({text:c,value:s+r+c,texts:c,time:i[r]}),a.push({text:l,value:s+r,texts:c,time:i[r]}),o.substr(11,2)}console.log(e);var d=e,u=this.pData2chang(a);console.log(d,u);for(s=0;s<d.length;s++)t[d[s].value]=u[d[s].text];this.$set(this.pickData2,"pData1",d),this.$set(this.pickData2,"pData2",t),this.pickData2.default.push(d[0]),this.pickData2.default.push(t[d[0].value][0]),this.defaultTime=d[0].text.substring(0,d[0].text.length-2)+":"+t[d[0].value][0].text.substring(0,t[d[0].value][0].text.length-2)+"前",console.log((new Date).getTime()),this.priceTime=d[0].time-(new Date).getTime(),this.getPrice(this.priceTime),this.getDefaultTime(d[0].time)},getMyDate:function(e){var t=new Date(e),a=t.getHours(),s=t.getMinutes();return console.log(new String(a)),new String(a).length<=1&&(a="0"+a),new String(s).length<=1&&(s="0"+s),a+":"+s},pData2chang:function(e){for(var t=[],a=0;a<e.length;a++)if(t[e[a].texts])t[e[a].texts].push(e[a]);else{var s=[];s.push(e[a]),t[e[a].texts]=s}return t},getDefaultTime:function(e){for(var t=e,a=[],s=0;s<this.reserveTimeList.length;s++)this.reserveTimeList[s].startTime<=t&&t<=this.reserveTimeList[s].endTime-9e5&&a.push({learve:this.reserveTimeList[s],times:this.reserveTimeList[s].endTime-t});if(1===a.length){this.params.shareStartTime=a[0].learve.startTime,this.params.shareEndTime=this.params.endTime=a[0].learve.endTime,this.params.startTime=t;var i=0!=(u=y(a[0].learve.endTime)).substr(5,1)?u.substr(5,2):u.substr(6,1),n=0!=u.substr(8,1)?u.substr(8,2):u.substr(9,1),r=u.substr(14,2),o=u.substr(11,2);this.leaveTime=i+"月"+n+"日"+o+":"+r+":00"}else{var l=a[0].times,c=a.length,d=a[0];for(s=1;s<c;s++)a[s].times>l&&(l=a[s].times,d=a[s]);var u;i=0!=(u=y(d.learve.endTime)).substr(5,1)?u.substr(5,2):u.substr(6,1),n=0!=u.substr(8,1)?u.substr(8,2):u.substr(9,1),r=u.substr(14,2),o=u.substr(11,2);this.leaveTime=i+"月"+n+"日"+o+":"+r+":00",this.params.shareStartTime=d.learve.startTime,this.params.shareEndTime=this.params.endTime=d.learve.endTime,this.params.startTime=t}},getPrice:function(e){var t=null,a=parseInt(e/6e4);console.log(a);for(var s=0;s<this.feeList.length;s++)if(a<=this.feeList[s].finishTime){t=s;break}s===this.feeList.length&&(t=s-1),this.feeList[t]&&(this.price=(this.feeList[t].fee*this.pointedItem.integralPermissionsCoefficient).toFixed(2)),console.log(this.price)},openPicker:function(){this.$root.eventHub.$emit("init"),0!==this.reserveTimeList.length?(this.$root.eventHub.$emit("refer"),this.$root.eventHub.$emit("refer"),this.show1=!0,this.isshow=!0):Object(n.Toast)({message:"没有预约的时间段",duration:1500})},confirmFn:function(e){console.log(e),this.systemTimeFlag?this.priceTime=this.systemTime-(new Date).getTime():this.priceTime=e.select2.time-(new Date).getTime(),this.getPrice(this.priceTime),this.defaultTime=e.select1.text.substring(0,e.select1.text.length-2)+":"+e.select2.text.substring(0,e.select2.text.length-2)+"前",this.getDefaultTime(e.select2.time),this.show1=!1,this.isshow=!1},close:function(e){this.show1=!1,this.isshow=!1},doPay:function(e){var t=this;return b()(I.a.mark(function a(){var s,i,r,o,l,c;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s="apiwrite/reserve/pay",i=null,r=null,o=null,l=1,a.next=7,E(s,e,l,i,r,o);case 7:2e3==(c=a.sent).error_code?(Object(n.Toast)({message:"预约成功",duration:1500}),setTimeout(function(){localStorage.setItem("routerFlag",null),t.$router.push("payToComplete")},1500)):Object(n.Toast)({message:c.error_message,duration:1500});case 9:case"end":return a.stop()}},a,t)}))()},goApoint:function(){var e=this;return b()(I.a.mark(function t(){var a,s,i,r,o,l,c,d,u,p,v,m,h;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.clickFlag){t.next=2;break}return t.abrupt("return");case 2:if(e.clickFlag=!1,a=[].concat(oe()(e.indentLists)),s=[].concat(oe()(e.plateLists)),i=a.join("")+s.join(""),e.plateNo=i,e.plateNo&&""!=e.plateNo){t.next=10;break}return Object(n.Toast)({message:"请选择您的车牌号",duration:1500}),t.abrupt("return");case 10:if(e.timeList.length){t.next=14;break}return e.messInfo(),e.getparklot(),t.abrupt("return");case 14:if(r=/^1(3|4|5|7|8)\d{9}$/,/([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}(([0-9]{5}[DF])|([DF]([A-HJ-NP-Z0-9])[0-9]{4})))|([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9挂学警港澳]{1})|^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/.test(e.plateNo)){t.next=20;break}Object(n.Toast)({message:"请输入正确的入场车牌号。",duration:1500}),t.next=73;break;case 20:if(r.test(e.phoneNumber)){t.next=24;break}Object(n.Toast)({message:"请输入正确的手机号码。",duration:1500}),t.next=73;break;case 24:if(""!=e.code&&null!=e.code&&void 0!=e.code&&e.code==e.randerCodes){t.next=28;break}Object(n.Toast)({message:"请输入正确的验证码。",duration:1500}),t.next=73;break;case 28:if(0!=e.pointedItem.reservableAmount){t.next=33;break}e.messInfo(),e.getparklot(),t.next=73;break;case 33:return e.params.plateNumber=e.plateNo,e.params.phone=e.phoneNumber,e.params.totalFee=e.price,e.params.parklotId=e.parkLotId,e.params.ip=localStorage.getItem("mobileId"),e.params.phoneModel=localStorage.getItem("phoneNum"),e.params.unionId=localStorage.getItem("unionId"),e.params.openId=localStorage.getItem("openId"),e.params.jpushId="H5",e.params.timestamp=+new Date,t.next=45,(f=e.params).timestamp=(new Date).getTime(),O("post",A+"apiwrite/wechat/saveUserBind",f);case 45:if(2e3!=(o=t.sent).error_code){t.next=59;break}if(e.clickFlag=!0,l=o.data.orderId,c=o.data.totalFee,localStorage.setItem("orderId",l),localStorage.setItem("userId",o.data.userId),localStorage.setItem("H5_fees",o.data.totalFee),!o.data.orderState||null==o.data.orderState){t.next=56;break}return 1301==o.data.orderState?(d=Object(n.Toast)({message:"您还有订单未完成",duration:1500}),u=setTimeout(function(){clearTimeout(u),d.close(),e.$router.push("reservationInfo")},1500)):1302==o.data.orderState||1303==o.data.orderState?(p=Object(n.Toast)({message:"您还有订单未完成",duration:1500}),v=setTimeout(function(){clearTimeout(v),p.close(),e.$router.push("reservationPaking")},1500)):1300==o.data.orderState?(m=Object(n.Toast)({message:"您还有订单未完成",duration:1500}),h=setTimeout(function(){clearTimeout(h),m.close(),e.$router.push("reservationBookingUnpaid")},1500)):(n.Indicator.close(),Object(n.Toast)({message:"该车辆已存在预约订单",duration:1500})),t.abrupt("return");case 56:0==c?e.doPay(l):(localStorage.setItem("routerFlag",null),e.$router.push({name:"payMentDt",params:{fees:c,orderId:l}})),t.next=73;break;case 59:if(2905!==o.error_code){t.next=65;break}return e.clickFlag=!0,e.messInfo(),t.abrupt("return");case 65:if(2904!==o.error_code){t.next=72;break}return e.clickFlag=!0,n.Indicator.close(),Object(n.Toast)({message:"该车辆已存在预约订单",duration:1500}),t.abrupt("return");case 72:2900===o.error_code?(e.clickFlag=!0,n.Indicator.close(),Object(n.Toast)({message:"你还有订单未完成",duration:1500})):2906==o.error_code?(e.clickFlag=!0,Object(n.Toast)({message:"您暂无预约资格，请联系物业管理员",duration:1500})):2325===o.error_code?(e.clickFlag=!0,n.Indicator.close(),Object(n.Toast)({message:"管理员不能预约车位",duration:1500})):(e.clickFlag=!0,Object(n.Toast)({message:o.error_message,duration:1500}));case 73:case"end":return t.stop()}var f},t,e)}))()},chooseCar:function(){this.$router.push({name:"licensePlate",params:{from:"licensePlate"}})},timeToget:function(){var e=Number((new Date).getTime())+9e5;this.nowTime=e}},created:function(){var e=this;this.parkLotId=Number(JSON.parse(localStorage.getItem("myParklotId"))),this.$root.eventHub.$on("hide-savety-confirm",function(){e.savetyConfirmShowed=!1})},deactivated:function(){clearInterval(this.timer),this.pagechange=!1,this.getSecond=null,v("H5_lslogin_time"),document.removeEventListener("visibilitychange",this.documentEvent)},activated:function(){this.clickFlag=!0,window.addEventListener("online",function(){Object(n.Toast)({message:"当前网络连接正常",position:"bottom",duration:1500}),n.Indicator.close()},!0),window.addEventListener("offline",function(){return Object(n.Toast)({message:"当前网络无连接",position:"bottom",duration:2e3}),n.Indicator.close(),!1},!0),this.timeToget(),this.getparklot(),this.plateNum="",this.proInfo="粤",this.iniInfo="B",this.code="",this.isGettingCodes=!1,this.timer&&(clearInterval(this.timer),this.isGettingCodes=!1),this.phoneList=localStorage.getItem("Phone_List"),null!==localStorage.getItem("Phone_List")&&(this.phoneList=localStorage.getItem("Phone_List").split(","));this.windowHeight=document.documentElement.clientHeight,window.addEventListener("resize",this.handleInput,!1)}},z()(pe,"deactivated",function(){this.$destroy(!0),window.removeEventListener("resize",_this.handleInput,!1)}),z()(pe,"beforeRouteLeave",function(e,t,a){this.plateNo="",n.MessageBox.close(!1),a()}),z()(pe,"beforeRouteEnter",function(e,t,a){a(function(e){"/car"===t.path&&(e.carPlate=JSON.parse(localStorage.getItem("H5_carplate")))})}),pe),he={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"appoint"},on:{click:function(t){e.hiddenJp(t)}}},[s("div",{ref:"apponitBox",staticClass:"content p-a",on:{click:e.isHideen}},[s("div",[s("div",{staticClass:"info car-info"},[s("div",{staticClass:"car-style"},[s("div",[s("div",{staticClass:"ic ic-font1"}),e._v(" "),s("span",{staticClass:"text"},[e._v(e._s(e.pointedItem.parklotName))]),e._v(" "),0===e.pointedItem.parklotKind?s("span",{staticClass:"cars-color"},[e._v("室内")]):1===e.pointedItem.parklotKind?s("span",{staticClass:"cars-color"},[e._v("室外")]):2===e.pointedItem.parklotKind?s("span",{staticClass:"cars-color"},[e._v("室内+室外")]):e._e()]),e._v(" "),s("div",{staticClass:"dis-2"},[s("span",{staticClass:"redNumber"},[e._v(e._s(e.pointedItem.reservableAmount))])])]),e._v(" "),s("div",{staticClass:"car-distance"},[s("div",{staticClass:"dis-inline"},[s("span",{staticClass:"text-distance"},[e._v(e._s(e.pointedItem.address))])]),e._v(" "),e._m(0)])]),e._v(" "),e._m(1),e._v(" "),s("div",{staticClass:"input-wrap"},[e._l(e.indentLists,function(t,a){return s("div",{key:a,class:["input-case",{caseactive:e.currentIndentIndex==a}],attrs:{inde:a,showflg:"1"},on:{click:function(t){e.changeInput(t)}}},[e._v(e._s(t))])}),e._v(" "),s("div",{class:["input-letter",{active:e.currentPlateIndex>0}],attrs:{showflg:"1"},on:{click:e.showKey}},e._l(e.plateLists,function(t,a){return s("span",{key:a,class:["letter-item",{letteractive:e.currentPlateIndex==a&&e.cursorFlag}],attrs:{showflg:"1"}},[e._v(e._s(t))])}))],2),e._v(" "),s("div",{staticClass:"textInfo"},[e._v("请输入正确车牌，否则道闸无法放行。")]),e._v(" "),e._m(2),e._v(" "),s("div",{staticClass:"info"},[s("div",{staticClass:"car-distance"},[s("div",{staticClass:"phone test-input p-r"},[s("span",{staticClass:"phone-ic input-ic p-a"}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneNumber,expression:"phoneNumber"}],staticClass:"phone",staticStyle:{"marging-top":"0.75rem"},attrs:{type:"number",placeholder:"请输入手机号码",maxlength:"11"},domProps:{value:e.phoneNumber},on:{input:[function(t){t.target.composing||(e.phoneNumber=t.target.value)},e.getPhoneList]}}),e._v(" "),e.isclosephone?[s("img",{staticClass:"imgsrc",attrs:{srcset:a("DahS")+" 2x, "+a("hdBt")+" 3x",alt:""},on:{click:e.closephone}})]:e._e(),e._v(" "),s("div",{staticClass:"alert-phone"},[s("ul",e._l(e.phoneArr,function(t,a){return s("li",{key:a,on:{click:function(a){e.getItem(t)}}},[e._v(e._s(t))])}))])],2),e._v(" "),s("div",{staticClass:"code test-input p-r"},[s("span",{staticClass:"code-ic input-ic p-a"}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],staticClass:"code",staticStyle:{"marging-top":"0.9rem"},attrs:{type:"number",placeholder:"请输入验证码",maxlength:"4"},domProps:{value:e.code},on:{input:[function(t){t.target.composing||(e.code=t.target.value)},e.inputCodeEvent]}}),e._v(" "),e.isclosecode?[s("img",{staticClass:"imgsrc",attrs:{srcset:a("DahS")+" 2x, "+a("hdBt")+" 3x",alt:""},on:{click:e.closeCode}})]:e._e(),e._v("\n             \n            "),s("span",{staticClass:"get-code-btn p-a t-c",on:{click:e.getCode}},[e._v(e._s(e.getCodeInfo))])],2)])]),e._v(" "),s("div",{staticClass:"info einlass plate-number"},[s("div",{staticClass:"text-3"},[e._v("入场时间")]),e._v(" "),s("div",{staticClass:"dis-2",on:{click:e.openPicker}},[s("div",[e._v(e._s(e.defaultTime))]),e._v("\n            \n          "),s("div",{staticClass:"ic ic-style"})])]),e._v(" "),s("div",{staticClass:"info stop-time"},[s("div",{staticClass:"text-3"},[e._v("可停至")]),e._v(" "),s("div",{staticClass:"exprie"},[e._v(e._s(e.leaveTime))])]),e._v(" "),e._m(3)])]),e._v(" "),s("div",{ref:"hiddenBtn",staticClass:"to-appoint t-c"},[s("div",{staticClass:"div-flex"},[s("div",{staticClass:"div-style ds-1"},[e._v("\n        预约费 \n        "),s("span",{staticStyle:{color:"#f63372"}},[e._v("￥\n          "),s("span",{staticClass:"price-style"},[e._v(e._s(e.price))])])]),e._v(" "),s("div",{staticClass:"div-style ds-2",on:{click:e.goApoint}},[e._v("立即预约")])])]),e._v(" "),s("div",{class:{alert:e.isshow},on:{click:e.closeZinde}}),e._v(" "),s("vue-pickers",{attrs:{show:e.show1,selectData:e.pickData2},on:{cancel:e.close,confirm:e.confirmFn}}),e._v(" "),s("transition",{attrs:{name:e.show?"slideUp":"slideDown"}},[s("key-board",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],attrs:{showflag:e.KeyBoardflag},on:{getinput:e.getkeyboard,hiden:e.hideKey}})],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"dis-inline"},[t("span",{staticClass:"black-location"},[this._v("空泊位")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"info text-plate"},[t("div",{staticClass:"plate-title"},[t("span",[this._v("请输入真实有效的车牌号码")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"info text-plate",staticStyle:{"padding-top":"0.7rem","padding-bottom":"0.7rem","font-size":"0.9rem",color:"#1a1a1a"}},[t("div",[t("span",{staticClass:"textMin"},[this._v("验证手机号码")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tips"},[t("div",{staticClass:"tips-text",staticStyle:{"font-size":"0.8rem",color:"#999999"}},[this._v("请按时离场，超时将收取额外费用。")])])}]};var fe=a("VU/8")(me,he,!1,function(e){a("QWQH")},null,null).exports,ge={name:"choosePlate",data:function(){return{timer:!1,scrollTop:0,leftCurrent:6,rightCurrent:1,leftEl:"",rightEl:"",offPadding:0,leftH:0,rightH:0,childrenH:0,proInfo:"",initInfo:"",provinces:["京","沪","鄂","湘","川","渝","粤","贵","青","琼","宁","吉","蒙","冀","苏","皖","云","陕","甘","藏","新","辽","鲁"],initials:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]}},props:["plateShowed"],methods:{hidePlate:function(){this.$root.eventHub.$emit("hide-plate")},_initScroll:function(){var e=this;this.$nextTick(function(){e.leftScroll?e.leftScroll.refresh():e.leftScroll=new w.a(e.$refs.leftBox,{probeType:3,scrollY:!0}),e.leftScroll.on("scroll",function(t){e.scrollTop=t.y,e.getCurrent("left")}),e.leftScroll.on("touchEnd",function(){setTimeout(function(){e.$refs.leftShow.style="transform:translate(0px, -"+e.leftCurrent*e.childrenH+"px) translateZ(0px) !important"},300)}),e.rightScroll?e.rightScroll.refresh():e.rightScroll=new w.a(e.$refs.rightBox,{probeType:3,scrollY:!0,click:!0}),e.rightScroll.on("scroll",function(t){e.scrollTop=t.y,e.getCurrent("right")}),e.rightScroll.on("touchEnd",function(){setTimeout(function(){e.$refs.rightShow.style="transform:translate(0px, -"+e.rightCurrent*e.childrenH+"px) translateZ(0px) !important"},300)}),e.initPlateHead()})},initPlateHead:function(){this.leftCurrent=6,this.rightCurrent=1,this.proInfo=this.provinces[this.leftCurrent],this.iniInfo=this.initials[this.rightCurrent],this.$refs.leftShow.style="transform:translate(0px, -240px) translateZ(0px) !important;",this.$refs.rightShow.style="transform:translate(0px, -40px) translateZ(0px) !important"},getCurrent:function(e){this.scrollTop>=0?"left"==e?this.leftCurrent=0:this.rightCurrent=0:"left"==e?this.scrollTop<-this.leftH-2*this.childrenH?this.leftCurrent=this.provinces.length-1:this.leftCurrent=Math.floor(Math.abs(this.scrollTop)/this.childrenH):this.scrollTop<-this.rightH-2*this.childrenH?(this.rightCurrent=this.initials.length-1,console.log(this.rightCurrent)):this.rightCurrent=Math.floor(Math.abs(this.scrollTop)/this.childrenH)},getElVal:function(){var e=this;this.$nextTick(function(){var t=e.$refs.leftBox,a=e.$refs.rightBox,s=t.children[0],i=a.children[0],n=s.children[0];e.leftEl=s,e.rightEl=i,e.leftH=s.offsetHeight,e.rightH=i.offsetHeight,e.childrenH=n.offsetHeight,e.offPadding=e.rightH-e.childrenH*e.provinces.length})},confirm:function(){console.log(this.proInfo+this.iniInfo),this.proInfo=this.provinces[this.leftCurrent],this.iniInfo=this.initials[this.rightCurrent];var e={proInfo:this.proInfo,iniInfo:this.iniInfo};this.$root.eventHub.$emit("confirm-plate-h",e)}},created:function(){var e=this;this.$root.eventHub.$on("show-plate-selection",function(){e._initScroll(),e.getElVal()})},computed:{},activated:function(){console.log(this.leftStyle,this.rightStyle),this._initScroll(),this.getElVal()}},_e={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"choose-plate"}},[a("transition",{attrs:{name:"mask-in"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.plateShowed,expression:"plateShowed"}],staticClass:"mask p-f",on:{click:e.hidePlate}})]),e._v(" "),a("transition",{attrs:{name:"choose-in"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.plateShowed,expression:"plateShowed"}],staticClass:"choose-box p-a"},[a("div",{staticClass:"content"},[a("div",{staticClass:"top t-c"},[e._v("选择车牌地区")]),e._v(" "),a("div",{staticClass:"main p-r"},[a("div",{ref:"leftBox",staticClass:"left-box p-a box"},[a("div",{ref:"leftShow",staticClass:"left show",style:e.leftStyle},e._l(e.provinces,function(t,s){return a("div",{key:t.name,staticClass:"l-list item t-c",class:{"pre-chosen":s==e.leftCurrent}},[e._v(e._s(t))])}))]),e._v(" "),a("div",{ref:"rightBox",staticClass:"right-box p-a box"},[a("div",{ref:"rightShow",staticClass:"right show",style:e.rightStyle},e._l(e.initials,function(t,s){return a("div",{key:t.name,staticClass:"r-list item t-c",class:{"pre-chosen":s==e.rightCurrent}},[e._v(e._s(t))])}))])]),e._v(" "),a("div",{staticClass:"bottom flex"},[a("div",{staticClass:"cancel t-c fl-o",on:{click:e.hidePlate}},[e._v("取消")]),e._v(" "),a("div",{staticClass:"confirm t-c fl-o",on:{click:e.confirm}},[e._v("确定")])])])])])],1)},staticRenderFns:[]};a("VU/8")(ge,_e,!1,function(e){a("aTSK")},null,null).exports;var Ce=/([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}(([0-9]{5}[DF])|([DF]([A-HJ-NP-Z0-9])[0-9]{4})))|([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9挂学警港澳]{1})/,Ie={name:"addCar",data:function(){return{plateNum:"",plateShowed:!1,proInfo:"粤",iniInfo:"B",cletoast:null,KeyBoardflag:0,show:0,indentLists:["粤","B"],plateLists:["车","牌","号","码",null,null,null],isPlateFlag:!0,cursorFlag:!1,currentPlateIndex:0,maxIndex:5,currentIndentIndex:null,clickFlag:!0}},components:{KeyBoard:ve},methods:{getkeyboard:function(e){if(this.isPlateFlag)"删"===e?this.delPlate(e):this.inputPlate(e);else{if("删"===e)return!1;this.inputIndent(e)}},hideKey:function(){this.show=!1},showKey:function(){this.KeyBoardflag=0,this.show=!0,this.isPlateFlag=!0,this.cursorFlag=!0,this.currentIndentIndex=null},inputPlate:function(e){var t=this,a=t.currentPlateIndex;t.cursorFlag=!0,0===a&&(t.plateLists=[null,null,null,null,null,null,null]);var s=[].concat(oe()(t.plateLists));a<=t.maxIndex&&(s[a]=e,t.plateLists=s,a++,t.currentPlateIndex=a)},delPlate:function(e){var t=this,a=t.currentPlateIndex;if(0===a)return!1;if(--a,t.currentPlateIndex=a,0===a)t.plateLists=["车","牌","号","码",null,null];else{var s=[].concat(oe()(t.plateLists));s[a]=null,t.plateLists=s}},inputIndent:function(e){var t=this,a=[].concat(oe()(t.indentLists)),s=t.currentIndentIndex;a[s]=e,t.indentLists=a,1===s?(t.isPlateFlag=!0,t.cursorFlag=!0,t.currentIndentIndex=null):(t.currentIndentIndex=1,t.KeyBoardflag=0)},changeInput:function(e){var t=this,a=Number(e.target.getAttribute("inde"));t.isPlateFlag=!1,t.cursorFlag=!1,t.show=!0,t.currentIndentIndex=a,t.KeyBoardflag=0===a?1:0},addCar:function(e){var t=this;return b()(I.a.mark(function a(){var s,i;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s=localStorage.getItem("userId"),a.next=3,O("post",A+"apiwrite/plate/add",{user_id:s,plate_num:e,timestamp:(new Date).getTime()});case 3:i=a.sent,t.clickFlag=!0,2e3===i.error_code?t.$router.push({path:"/licensePlate"}):2500===i.error_code?Object(n.Toast)("车牌号码已存在"):console.log("错误码是："+i.error_code);case 6:case"end":return a.stop()}},a,t)}))()},addPlate:function(){var e=this,t=[].concat(oe()(e.indentLists)),a=[].concat(oe()(e.plateLists)),s=t.join("")+a.join("");e.show=!1,e.clickFlag&&(e.clickFlag=!1,s.length<7?(Object(n.Toast)({message:"请输入正确的入场车牌号",position:"bottom",duration:1500}),e.clickFlag=!0):Ce.test(s)?e.addCar(s):(Object(n.Toast)({message:"请输入正确的入场车牌号",position:"bottom",duration:1500}),e.clickFlag=!0))}},created:function(){},activated:function(){},deactivated:function(){this.$destroy(!0)}},Te={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"add-car"}},[a("div",{staticClass:"content p-a"},[a("div",{staticClass:"warn"},[e._v("请输入真实有效的车牌号码")]),e._v(" "),a("div",{staticClass:"input-wrap"},[e._l(e.indentLists,function(t,s){return a("div",{key:s,class:["input-case",{caseactive:e.currentIndentIndex==s}],attrs:{inde:s},on:{click:function(t){e.changeInput(t)}}},[e._v(e._s(t))])}),e._v(" "),a("div",{class:["input-letter",{active:e.currentPlateIndex>0}],on:{click:e.showKey}},e._l(e.plateLists,function(t,s){return a("span",{key:s,class:["letter-item",{letteractive:e.currentPlateIndex==s&&e.cursorFlag}]},[e._v(e._s(t))])}))],2),e._v(" "),a("div",{staticClass:"add-btn"},[a("div",{staticClass:"add-btn-style",on:{click:e.addPlate}},[e._v("确定")])])]),e._v(" "),a("transition",{attrs:{name:e.show?"slideUp":"slideDown"}},[a("key-board",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],attrs:{showflag:e.KeyBoardflag},on:{getinput:e.getkeyboard,hiden:e.hideKey}})],1)],1)},staticRenderFns:[]};var be=a("VU/8")(Ie,Te,!1,function(e){a("h1qs")},null,null).exports,ke=a("BO1k"),ye=a.n(ke),we={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"no-data-tip"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!this.parkItems.length,expression:"!parkItems.length"}],staticClass:"img-box p-a",class:[this.tipClass]})])},staticRenderFns:[]};var De=a("VU/8")({name:"noDataTip",data:function(){return{tipsArr:["no-data","no-card","no-counp","no-park","no-park-lot"]}},props:["tipMark","parkItems"],computed:{tipClass:function(){var e=0;switch(this.tipMark){case"暂无数据":case"暂无车辆":case"暂无预约":e=0;break;case"暂无银行卡":e=1;break;case"暂无优惠券":e=2}return this.tipsArr[e]}}},we,!1,function(e){a("B1Ov")},null,null).exports,xe={name:"car",data:function(){return{headerMark:"我的车辆",carItems:[],editMode:!1,fromName:"myAcount",msg:"",hasNoCars:!1,currentIndex:1,tipMark:"暂无车辆",pageNum:0}},components:{subHeader:_,noDataTips:De},methods:{_initScroll:function(){var e=this;this.$nextTick(function(){e.scroll?e.scroll.refresh():e.scroll=new w.a(e.$refs.carListsBox,{probeType:3,scrollY:!0,click:!0});var t=e;e.scroll&&e.scroll.on(scrollY,function(a){clearTimeout(t.timer);var s=a.y,i=e.scroll.scroller,n=i.parentElement,r=i.offsetHeight;s<n.offsetHeight-r&&(t.timer=setTimeout(function(){t.pageNum++,t.getCars()},30))})})},chooseItem:function(e){if(this.fromName=localStorage.getItem("fromName"),this.editMode){if(!this.editMode)return;console.log(this.$router.from),this.$set(e,"isChosen",!e.isChosen)}else{var t={plateNo:e.number,plateNoId:e.plateId};localStorage.setItem("H5_chosen_plate",p()(t)),this.$router.push("reservationOld")}},switchBars:function(e){this.editMode?0==e?this.editMode=!1:this.removePlate():0==e?this.editMode=!0:this.$router.push({path:"/licensePlateAdd"})},removePlate:function(){var e=this;return b()(I.a.mark(function t(){var a,s,i,n,r,o,l,c,d;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(console.log(e.carItems),a=[],s=!0,i=!1,n=void 0,t.prev=5,r=ye()(e.carItems);!(s=(o=r.next()).done);s=!0)!0===(l=o.value).isChosen&&(c=l.plateId,a.push(c));t.next=13;break;case 9:t.prev=9,t.t0=t.catch(5),i=!0,n=t.t0;case 13:t.prev=13,t.prev=14,!s&&r.return&&r.return();case 16:if(t.prev=16,!i){t.next=19;break}throw n;case 19:return t.finish(16);case 20:return t.finish(13);case 21:if(console.log(a),0!==a.length){t.next=26;break}return t.abrupt("return");case 26:d=a.toString(),e.removeCar(d);case 28:case"end":return t.stop()}},t,e,[[5,9,13,21],[14,,16,20]])}))()},getCars:function(){var e=this;return b()(I.a.mark(function t(){var a,s;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.Indicator.open(),a=localStorage.getItem("userId"),t.next=4,i=a,r=e.pageNum,O("post",A+"apiread/plate/get",{user_id:i,page_num:r,timestamp:(new Date).getTime()});case 4:s=t.sent,console.log(s),2e3==s.error_code?(n.Indicator.close(),0===s.data.plates.length?(e.editMode=!1,e.carItems=[]):e.displayItems(s)):(n.Indicator.close(),Object(n.Toast)({message:"车牌号数据请求失败",duration:1e3}));case 7:case"end":return t.stop()}var i,r},t,e)}))()},removeCar:function(e){var t=this;return b()(I.a.mark(function a(){var s,i;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s=localStorage.getItem("userId"),a.next=3,O("post",A+"apiwrite/plate/del",{user_id:s,plate_id:e,timestamp:(new Date).getTime()});case 3:i=a.sent,console.log(i),2e3===i.error_code?t.getCars():console.log(i,"错误码"+i.error_code);case 6:case"end":return a.stop()}},a,t)}))()},displayItems:function(e){var t=e.data.plates;0===this.pageNum?this.carItems=[].concat(t):this.carItems=this.carItems.concat(t),this._initScroll()}},created:function(){var e=this;this.getCars(),this.fromName=this.$route.params.from,void 0!=this.fromName?localStorage.setItem("fromName",this.fromName):this.fromName=localStorage.getItem("fromName"),this.$root.eventHub.$on("refresh-cars",function(){e.pageNum=0,e.getCars()}),"apoint"==this.fromName||this.hasNoCars,this.currentIndex=0},activated:function(){this.getCars(),this.editMode=!1,this.fromName=this.$route.params.from,console.log(this.fromName),void 0!=this.fromName?localStorage.setItem("fromName",this.fromName):this.fromName=localStorage.getItem("fromName"),console.log(this.fromName),"apoint"==this.fromName||this.hasNoCars,this.currentIndex=0},computed:{barItems:function(){return this.editMode?["保存","删除"]:["编辑车辆","添加车辆"]}},beforeRouteEnter:function(e,t,a){a()}},Se={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"car"}},[a("no-data-tips",{attrs:{tipMark:e.tipMark,parkItems:e.carItems}}),e._v(" "),a("div",{ref:"carListsBox",staticClass:"content-box p-a"},[a("div",{staticClass:"content"},e._l(e.carItems,function(t,s){return a("div",{key:t.name,staticClass:"car-lists p-r",class:{"bd-top":0==s,edited:e.editMode},on:{click:function(a){e.chooseItem(t)}}},[e._v("\n        "+e._s(t.number)+"\n        "),a("transition",{attrs:{name:"fade-in"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.editMode,expression:"editMode"}],staticClass:"edit-ic p-a",class:{chosen:t.isChosen}})])],1)}))]),e._v(" "),a("div",{staticClass:"bottom-bars flex p-a"},e._l(e.barItems,function(t,s){return a("div",{key:t.name,staticClass:"bar-lists fl-o t-c",class:{active:1==s},on:{click:function(t){e.switchBars(s)}}},[e._v("\n        "+e._s(t)+"\n      ")])}))],1)},staticRenderFns:[]};var Ne=a("VU/8")(xe,Se,!1,function(e){a("5OO2")},null,null).exports,Fe={name:"counp",data:function(){return{headerMark:"我的卡券",counpItems:[],pageNum:0,pageSize:20,chosen:!1,canChoose:!0,currentIndex:null,isLoading:!1,timer:null,hasNoDatas:!1,tipMark:"暂无优惠券",counpNumber:null,clearX:!0,orderId:null,counpFlag:null}},components:{subHeader:_,noDataTips:De},methods:{getCounpEvent:function(){""!==this.counpNumber&&null!==this.counpNumber&&void 0!==this.counpNumber?this.getCounp():Object(n.Toast)("请您输入优惠券编码")},getCounp:function(){var e=this;return b()(I.a.mark(function t(){var a,s;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=localStorage.getItem("userId"),t.next=3,i=a,r=e.counpNumber,O("post",A+"apiwrite/coupon/exchange",{user_id:i,coupon_code:r,timestamp:(new Date).getTime()});case 3:s=t.sent,console.log(s),2e3==s.error_code?(Object(n.Toast)("优惠券兑换成功"),e.pageNum=0,e.getCounpLists()):2502==s.error_code?Object(n.Toast)("优惠券已经被兑换过了"):2217==s.error_code?(Object(n.Toast)("优惠券码参数错误"),console.log(s,"错误码是="+s.error_code)):2304==s.error_code||2312==s.error_code?Object(n.Toast)("没有这个优惠券"):Object(n.Toast)("错误码是"+s.error_code);case 6:case"end":return t.stop()}var i,r},t,e)}))()},getCounpLists:function(){var e=this;return b()(I.a.mark(function t(){var a,s;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return 0==e.pageNum&&n.Indicator.open(),a=localStorage.getItem("userId"),t.next=4,L(a,e.pageNum);case 4:s=t.sent,console.log(s),"2000"==s.error_code?(n.Indicator.close(),e.displayItems(s)):(n.Indicator.close(),Object(n.Toast)({message:"优惠券信息获取失败",duration:1e3}));case 7:case"end":return t.stop()}},t,e)}))()},displayItems:function(e){var t;t=e.data.coupons;var a=!0,s=!1,i=void 0;try{for(var n,r=ye()(t);!(a=(n=r.next()).done);a=!0){var o=n.value,l=o.endTime;l="4100688000000"==l?"无限期":"有效期至："+(l=y(l)).substr(0,10),this.$set(o,"fmInvalidDate",l)}}catch(e){s=!0,i=e}finally{try{!a&&r.return&&r.return()}finally{if(s)throw i}}0==this.pageNum?this.counpItems=[].concat(t):this.counpItems=this.counpItems.concat(t),this._initScroll(),this.isLoading=!1,this.scroll&&this.scroll.refresh()},chooseItems:function(e,t){var a=this;if(this.canChoose){if(e.isChosen)s.default.set(e,"isChosen",!1),localStorage.removeItem("H5_counpinfo"),this.bingCounpId(),this.currentIndex=null,this.$root.eventHub.$emit("cancel-counp-info");else{var i=!0,n=!1,r=void 0;try{for(var o,l=ye()(this.counpItems);!(i=(o=l.next()).done);i=!0){var c=o.value;s.default.set(c,"isChosen",!1)}}catch(e){n=!0,r=e}finally{try{!i&&l.return&&l.return()}finally{if(n)throw r}}s.default.set(e,"isChosen",!0),this.currentIndex=t;var d={couponId:e.userCouponId,amount:e.couponLimit},u=p()(d);localStorage.setItem("H5_counpinfo",u),this.$root.eventHub.$emit("send-counp-info",d),this.bingCounpId()}Object(Q.setTimeout)(function(){a.$router.push({name:"payMentDt"})},300)}},bingCounpId:function(){var e=this;return b()(I.a.mark(function t(){var a,s;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=null===(a=localStorage.getItem("H5_counpinfo"))?-1:JSON.parse(localStorage.getItem("H5_counpinfo")).couponId,console.log(a),t.next=5,i=a,n=e.orderId,O("post",A+"apiwrite/coupon/bindOrderParking",{coupon_id:i,order_parking_id:n,timestamp:(new Date).getTime()});case 5:s=t.sent,console.log(s),2e3===s.error_code?console.log("优惠券使用信息到后台"):console.log(s,"错误码是="+s.error_code);case 8:case"end":return t.stop()}var i,n},t,e)}))()},_initScroll:function(){var e=this;this.$nextTick(function(){e.scroll?e.scroll.refresh():e.scroll=new w.a(e.$refs.counpBox,{probeType:3,scrollY:!0,click:!0});var t=e;e.scroll&&e.scroll.on("scroll",function(a){Object(Q.clearTimeout)(t.timerup),Object(Q.clearTimeout)(t.timer);var s=a.y;console.log(s),s>30&&(t.timerup=Object(Q.setTimeout)(function(){t.pageNum=0,t.getCounpLists()},30));var i=e.scroll.scroller,n=i.parentElement,r=i.offsetHeight;s<n.offsetHeight-r&&(t.timer=Object(Q.setTimeout)(function(){t.isLoading=!0,t.pageNum++,t.getCounpLists()},30))})})}},created:function(){this.getCounpLists();var e=this;Object(Q.setInterval)(function(){e.getCounpLists()},3e4)},beforeMount:function(){this.getCounpLists()},activated:function(){this.orderId=localStorage.getItem("orderId");var e=localStorage.getItem("counpFlag");if(-1==e)this.pageNum=0,this.getCounpLists(),this.currentIndex=null;else{var t=!0,a=!1,s=void 0;try{for(var i,n=ye()(this.counpItems);!(t=(i=n.next()).done);t=!0){var r=i.value;r.userCouponId==e&&this.$set(r,"isChosen",!0)}}catch(e){a=!0,s=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw s}}}console.log(this.counpItems)},deactivated:function(){this.counpNumber=null;var e=!0,t=!1,a=void 0;try{for(var s,i=ye()(this.counpItems);!(e=(s=i.next()).done);e=!0){var n=s.value;this.$set(n,"isChosen",!1)}}catch(e){t=!0,a=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw a}}this.scroll.scrollTo(0,0)}},Oe={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"counp"}},[a("mt-field",{staticClass:"in-style",attrs:{label:"",placeholder:"请输入优惠券编号",type:"text",disableClear:e.clearX},model:{value:e.counpNumber,callback:function(t){e.counpNumber=t},expression:"counpNumber"}},[a("div",{staticClass:"get-btn",on:{click:e.getCounpEvent}},[e._v("兑换")])]),e._v(" "),a("div",{ref:"counpBox",staticClass:"coup-box p-a"},[a("div",{staticClass:"counp-content"},[a("no-data-tips",{attrs:{tipMark:e.tipMark,parkItems:e.counpItems}}),e._v(" "),e._l(e.counpItems,function(t,s){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.counpItems.length,expression:"counpItems.length"}],key:s,staticClass:"counp-list-box",on:{click:function(a){e.chooseItems(t,t.userCouponId)}}},[a("div",{staticClass:"counp-list p-r",class:{chosen:t.userCouponId==e.currentIndex}},[a("div",{staticClass:"top-logo",class:{enpire:0!==t.state}}),e._v(" "),a("div",{staticClass:"content clearfix"},[a("div",{staticClass:"counp-l f-l clearfix"},[a("div",{staticClass:"rmb f-l"},[e._v("￥")]),e._v(" "),a("div",{staticClass:"amount f-l"},[a("div",{staticClass:"num t-c"},[e._v(e._s(t.couponLimit))])])]),e._v(" "),a("div",{staticClass:"counp-r f-r"},[a("div",{staticClass:"type t-r"},[e._v("\n                "+e._s(t.districtName)+"\n              ")]),e._v(" "),a("div",{staticClass:"date"},[e._v(e._s(t.fmInvalidDate))])])]),e._v(" "),a("div",{staticClass:"p-a",class:{"choose-ic":t.userCouponId==e.currentIndex}})])])}),e._v(" "),a("mt-spinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],attrs:{type:"fading-circle",color:"#999",size:20}})],2)])],1)},staticRenderFns:[]};var Me=a("VU/8")(Fe,Oe,!1,function(e){a("FY8l")},null,null).exports,Ae=(a("1nuA"),{name:"payMent",data:function(){return{headerMark:"支付订单",currentIndex:0,payFees:0,discounts:0,myAcounts:0,counpNum:0,couponId:-1,orderId:"",isChoosed:!1,onlyYuErPay:!1,payWays:[{name:"微信支付",info:"推荐微信5.0以上用户使用",class:"weixin"}],url:"",type:5,payState:!1,payUrl:"",orderState:null,timeInter:null,time:0,timeflag:!1}},components:{subHeader:_},methods:{_initScroll:function(){var e=this;this.$nextTick(function(){e.scroll?e.scroll.refresh():e.scroll=new w.a(e.$refs.payMentBox,{probeType:3,scrollY:!0,click:!0})})},getCounpNum:function(){var e=this;return b()(I.a.mark(function t(){var a,s;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=localStorage.getItem("userId"),t.next=3,L(a,0);case 3:2e3===(s=t.sent).error_code&&(e.counpNum=s.data.coupons.length);case 5:case"end":return t.stop()}},t,e)}))()},confirmPay:function(){var e=this;return b()(I.a.mark(function t(){return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(-1===e.couponId&&(e.couponId=null),!m("H5_timeflag")){t.next=7;break}return e.messInfo(),t.abrupt("return");case 7:!0===e.orderState?e.payUrl="apiwrite/parking/pay":e.payUrl="apiwrite/reserve/pay",e.wxPay();case 9:case"end":return t.stop()}},t,e)}))()},messInfo:function(){var e=this;Object(n.MessageBox)({title:"温馨提示",message:'\n                      <div class="paymessage-info">\n                        <div class="is-text">支付超时，请重新支付。</div>\n                      </div>',showConfirmButton:!0,confirmButtonText:"确认",showCancelButton:!1}).then(function(t){"confirm"==t&&(h("H5_payMent_time"),h("H5_timeflag"),Object(Q.clearInterval)(e.timeInter),alert(e.orderState),e.orderState?e.$router.push("reservationPaking"):(localStorage.removeItem("orderId"),e.$router.push("reservationOld")))}).catch(function(e){})},selectPayWays:function(e,t){this.onlyYuErPay?this.currentIndex=0:(this.currentIndex=t,localStorage.setItem("H5_currentIndex",t))},wxPay:function(){var e=this;return b()(I.a.mark(function t(){var a,s,i,r;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=localStorage.getItem("mobileId"),s=5,t.next=4,E(e.payUrl,e.orderId,s,e.couponId,a);case 4:2e3===(i=t.sent).error_code?1===i.data.isZero?(Object(n.Toast)({message:"支付成功",duration:1500}),Object(Q.setTimeout)(function(){h("H5_payMent_time"),h("H5_timeflag"),localStorage.removeItem("H5_fees"),localStorage.removeItem("H5_order_state"),Object(Q.clearInterval)(e.timeInter),e.orderState?e.$router.push({name:"payToComplete",params:{flag:1}}):e.$router.push("payToComplete")},1500)):((r={}).appId=i.data.appId,r.timeStamp=i.data.timeStamp,r.nonceStr=i.data.nonceStr,r.package="prepay_id="+i.data.prepayId,r.signType="MD5",r.paySign=i.data.sign,"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",onBridgeReady,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",onBridgeReady),document.attachEvent("onWeixinJSBridgeReady",onBridgeReady)):e.onBridgeReady(r)):console.log(i,"错误码是"+i.error_code);case 6:case"end":return t.stop()}},t,e)}))()},onBridgeReady:function(e){var t=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign},function(e){var a=this;"get_brand_wcpay_request:ok"==e.err_msg?(Object(n.Toast)({message:"支付成功",duration:1500}),Object(Q.setTimeout)(function(){h("H5_payMent_time"),h("H5_timeflag"),localStorage.removeItem("H5_fees"),localStorage.removeItem("H5_order_state"),Object(Q.clearInterval)(a.timeInter),t.orderState?t.$router.push({name:"payToComplete",params:{flag:1}}):t.$router.push("/payToComplete")},1500)):console.log("支付失败，继续停留在这个页面")})},goCounp:function(){localStorage.setItem("H5_isChoosed",!0),localStorage.setItem("counpFlag",this.couponId),this.$router.push({name:"ticket"})},timeAdd:function(){var e=this;this.timeInter&&(Object(Q.clearInterval)(this.timeInter),this.timeInter=null),this.timeInter=Object(Q.setInterval)(function(){e.time++,e.time>=60&&(e.timeflag=!0,v("H5_timeflag",e.timeflag),Object(Q.clearInterval)(e.timeInter))},1e3)},documentEvent:function(){var e=this;if("visible"==document.visibilityState){Object(Q.clearInterval)(e.timeInter);var t=Date.parse(new Date),a=m("H5_payMent_time"),s=Number(t)-Number(a);s+="",e.time=s.substring(0,s.length-3),console.log(e.time),e.time>=300?(e.timeflag=!0,v("H5_timeflag",e.timeflag)):e.timeAdd()}else e.timeInter&&Object(Q.clearInterval)(e.timeInter)}},computed:{channel:function(){return parseInt(this.currentIndex+1)},payAmounts:function(){return(this.payFees-this.discounts>=0?this.payFees-this.discounts:0).toFixed(2)},counpsTips:function(){return this.discounts>0?"已优惠"+this.discounts+"元":this.counpNum>0?"有可用优惠券":"无可用优惠券"}},beforeCreate:function(){this.payFees=localStorage.getItem("H5_fees")},created:function(){var e=this,t=Date.parse(new Date);v("H5_payMent_time",t),v("H5_timeflag",this.timeflag),this.payFees=localStorage.getItem("H5_fees"),void 0===this.discounts&&(this.discounts=0),this.getCounpNum(),this._initScroll(),this.$root.eventHub.$on("send-counp-info",function(t){e.discounts=t.amount,e.couponId=t.couponId}),this.$root.eventHub.$on("cancel-counp-info",function(){e.discounts=0,e.couponId=-1})},mounted:function(){},activated:function(){var e=this,t=localStorage.getItem("H5_order_state");alert(t),this.orderState=1303==t,this.currentIndex=0,this.timeAdd(),this.orderId=localStorage.getItem("orderId");var a=Date.parse(new Date);v("H5_payMent_time",a),document.addEventListener("visibilitychange",this.documentEvent,!1),this.$root.eventHub.$on("send-counp-info",function(t){e.discounts=t.amount,e.couponId=t.couponId}),this.$root.eventHub.$on("cancel-counp-info",function(){e.discounts=0,e.couponId=-1}),this.payFees=localStorage.getItem("H5_fees");JSON.parse(localStorage.getItem("H5_repay"));this.getCounpNum();Number(this.payFees);console.log(this.discounts)},beforeRouteLeave:function(e,t,a){a()},beforeRouteEnter:function(e,t,a){"/appoint"!=t.path&&"/appointment"!=t.path&&"/orderInfo"!=t.path||a(function(e){e.payFees=Number(localStorage.getItem("H5_fees")),e.orderId=localStorage.getItem("orderId")}),a()},deactivated:function(){this.discounts=0,this.couponId=-1,this.time="",Object(Q.clearInterval)(this.timeInter),document.removeEventListener("visibilitychange",this.documentEvent,!1)}}),Be={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"payment",attrs:{id:"pay-ment"}},[a("div",{ref:"payMentBox",staticClass:"pay-ment-box"},[a("div",{staticClass:"content"},[a("div",{staticClass:"coup"},[a("div",{staticClass:"ct-info",staticStyle:{"margin-top":".5rem"}},[e._v("选择优惠券信息")]),e._v(" "),a("div",{staticClass:"ct-item clearfix",on:{click:e.goCounp}},[e._v("优惠券"),a("span",{staticClass:"coup-ic f-r"}),a("span",{staticClass:"coup-num f-r"},[e._v(e._s(e.counpsTips))])])]),e._v(" "),a("div",{staticClass:"payWays p-r"},[a("div",{staticClass:"ct-info"},[e._v("请选择支付方式")]),e._v(" "),e._l(e.payWays,function(t,s){return a("div",{key:t.name,staticClass:"pay-item ct-item p-r clearfix",on:{click:function(a){e.selectPayWays(t,s)}}},[a("div",{staticClass:"pay-ic p-a",class:[t.class]}),e._v(" "),a("div",{staticClass:"pay"},[a("div",{staticClass:"name"},[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"info"},[e._v(e._s(t.info))])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.currentIndex==s,expression:"currentIndex == index"}],staticClass:"choose-ic p-a"})])})],2),e._v(" "),a("div",{staticClass:"comfirm t-c",on:{click:e.confirmPay}},[a("span",{staticClass:"t-c"},[e._v("确认支付："+e._s(e.payAmounts)+"元")])])])])])},staticRenderFns:[]};var Le=a("VU/8")(Ae,Be,!1,function(e){a("QWnr")},null,null).exports,Re={name:"payMent",data:function(){return{headerMark:"支付完成",routerFlag:null}},components:{subHeader:_},methods:{btn1:function(){localStorage.setItem("routerFlag",null),localStorage.setItem("orderId",null),this.$router.push({name:"reservationOld"})},btn2:function(){window.location.href="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz=MzU0MzE3OTk3NA==&scene=124#wechat_redirect"},btnOrderInfoEvent:function(){this.$router.push({name:"reservationinfo"})}},created:function(){},activated:function(){this.routerFlag=localStorage.getItem("routerFlag")}},Ee={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"pay-To-Complete"}},[s("div",{staticClass:"bgc"}),e._v(" "),"reservationPaking"==e.routerFlag?s("div",{staticClass:"comfirm",on:{click:e.btn1}},[e._v("再次预约")]):s("div",{staticClass:"comfirm",on:{click:e.btnOrderInfoEvent}},[e._v("查看订单")]),e._v(" "),s("img",{staticClass:"bgc2",attrs:{src:a("MA6U")}}),e._v(" "),s("div",{staticClass:"text"},[e._v("关注公众号，随时预约更多停车场空泊位。")])])},staticRenderFns:[]};var He=a("VU/8")(Re,Ee,!1,function(e){a("Bt7k")},null,null).exports;s.default.use(d.a);var Pe=new d.a({routes:[{path:"/reservationPaking",name:"reservationPaking",component:G},{path:"/reservationinfo",name:"reservationinfo",component:Z},{path:"/reservationBookingUnpaid",name:"reservationBookingUnpaid",component:K},{path:"/reservationOld",name:"reservationOld",component:ne},{path:"/reservationNew",name:"reservationNew",component:fe},{path:"/licensePlateAdd",name:"licensePlateAdd",component:be},{path:"/licensePlate",name:"licensePlate",component:Ne},{path:"/ticket",name:"ticket",component:Me},{path:"/payMentDt",name:"payMentDt",component:Le},{path:"/payToComplete",name:"payToComplete",component:He},{path:"/reservationComplete",name:"reservationComplete",component:ee}]});a("v2ns"),a("gsqX"),a("sVYa");s.default.use(r.a),s.default.prototype.$http=x.a,s.default.config.productionTip=!1,s.default.use(i.a),new s.default({el:"#app",data:{eventHub:new s.default},router:Pe,store:S,components:{App:c},template:"<App/>",created:function(){S.eventHub=this}})},QWQH:function(e,t){},QWnr:function(e,t){},"V+Cx":function(e,t){},XsYe:function(e,t){},aTSK:function(e,t){},avfW:function(e,t){},"d8/S":function(e,t){},de84:function(e,t){},eMi9:function(e,t){},h1qs:function(e,t){},hHfE:function(e,t){},hdBt:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA4CAYAAAC2TwutAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2MDExRDAzNDIxMEQxMUU4ODI1NUNGOTRBMkZCNDdEQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2MDExRDAzNTIxMEQxMUU4ODI1NUNGOTRBMkZCNDdEQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjYwMTFEMDMyMjEwRDExRTg4MjU1Q0Y5NEEyRkI0N0RCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjYwMTFEMDMzMjEwRDExRTg4MjU1Q0Y5NEEyRkI0N0RCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+3atC1QAABQpJREFUeNrcmglsFUUYx+dVggWiCFgkpdBWWvEgQMWEKLGEQyxHOAQqSkJERdOg0kKIKJ5AuSIgNkpegKYQ0DTcReRQQMEjapBiBK0IgnIYhRoNR1st+n15/yXb5c23+97bfW/bL/kn7c63M/vLzJv5vpkJBINB1RStWRNguI00jvQPaQvpiBUsQBoKx69InzYCqOGkclIy/n+N9BBpmwGWRNpKGmJ6aTmpgFTvUyjuhHWk5qZn/PciBkvCg4ctUGyTSKWk63wINZi00QJlWFejp9h6aSqYQFph8vOD5ZE2aaDYDprBfhQqegzDMuADqAcBdb2mvIZUaAZbTfpSqPBxH8ANAlSypryWNIq0zwxWg99YpVDxE6RgguAGAKqFprwOUDuUaTY0rJr0AOmQ0ABPKMviDNePVEFqaQO13fzQOimcA9y3QkNPk0riBNeX9L4N1GjSB9aCcLPdH6SBpO+EBieTlnoMl4sPlqDyAa6cgBlw/UmHhYafJS3xCO5+B1CPIIRSkYCZ4b4XfKaQFrsM1YcjB1IrTTnHhI9igVbRgLH9DrgfBJ9CF+HuQ0/doCn/F1Ab7CpyElH8BrgqwaeItDBGqHsBdaOmvB5Q651U5jRUOgs4KUKZTpofJVRvTNetBajxCHqVm2BsZwB3VPB5njQ3Qqh7SDttoCYgPVFegLGdBtwxwecF0hyH9XHw/aENFMeq70Y6BKKJ2k8hGjgu+MxE0ifZ3YC6SYDiGHVNNGM72nTkV8D9LPi8CoWzHEC1EaCeRHCu4gnG9gvgTgg+3GsvW571BFRbzTv/kZ4ilcUyxcaaQJ4E3EnBZxaGJlt30i5SOwHKyNwTvkt1AhPKx6ROGh+eTNojDEoRoDjAXunGSu9Wyn8cPXdK8HnOBqoAyazyE5jCEmAHp4OajCRW+RGM7ScMy9MRQE1B8qr8DKYQmfRHpGIHVYSkVTUGsEiHoWosYNmkPaRUGz9OUN/E78v3YFmA6ujQP4ChWOBnsFtJe0lpEb7HcG9jDfMdWKYDqLew3aCDW4aowzdgGYDqLPi8hGmdt/bOCXBBRPQJB0sHVLrg8wqpGH8fAtx5AY6jj4mJBOsEqAyb6H625Vkl4KqFb1qOBDPuYGmAyhR8GOh1TdlBwP2pKeczuRXYEogbmAHVRfApxhCU7BvA/SXAlWITx3OwjlinsgSfeZgsnNgBB3CrVOjw3DOwVEBlCz4LSC9G+A1fq9CBngTH+x75XoB1IO1WoRsFOnuDNCPKnwQfOg62geOdqrFugt2Cnrpd8OHDiekxztBfqNDh4982cGPcAGsPqDsEHw5kp7oUMHwOuAvCVsZaFbrLETVYCqDuFHyWughl2GeAu6gp59sC75FGRgNmQN0lvFuCRNGLnGo/4C4JcLzlPTwSsJtVaN+vm9DwO4j9PEsUVej03w6ODymGOQFrB6geQoMcqD7jMZRhn+DDJbgN6tpbRQ3A2gKqp9CQcb8qHlCGcZQzwgaOTzfzwoHxpRA+dMsRGliJZDCeUIZ9pEJXHi5ryvmmziYs9A3AONjsLVRciiQwEVCG7QJcjaY8GXC5ZjApoijzAZRhOwFXqylvgXX1KtgBjSMf4/BxzhXlH9sBuDpNeY4ZrBzj2NpTnKb78SLmdkQf4eCqjBBFoUc4CB2KPKsSC7SfbRuCYvPVWQadZgZj4zsUW1TjsgosT+Pw/ZsVbhM1hVvcVeG2IP4XYADriw92d7r2zgAAAABJRU5ErkJggg=="},m5d5:function(e,t){},umeQ:function(e,t){},v2ns:function(e,t){},zxHr:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.84432475f2d00cc78b19.js.map